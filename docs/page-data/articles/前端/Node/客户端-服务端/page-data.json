{"componentChunkName":"component---src-templates-post-js","path":"/articles/前端/Node/客户端-服务端/","result":{"data":{"markdownRemark":{"fields":{"articlePath":"/articles/前端/Node/客户端-服务端/"},"html":"<h1>Client程序</h1>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">window.onload = function winLoad(){\n    var form = document.querySelector(&#39;form&#39;);\n    var select = document.querySelector(&#39;select&#39;);\n    var input = document.querySelector(&#39;input[type=&quot;text&quot;]&#39;);\n    var main = document.querySelector(&#39;main&#39;);\n    var submit = document.querySelector(&#39;input[type=&quot;submit&quot;]&#39;);\n    var form_data = {};        \n\n    var updata = (function (){\n        var xhr = new XMLHttpRequest();                \n        xhr.onload = ()=&gt;{\n            var responseData= JSON.parse(xhr.response);\n        }\n\n        return function(url){            \n            xhr.open(&#39;GET&#39;, url);\n            xhr.responseType = &#39;json&#39;;            \n            xhr.send(null);\n        }        \n    })();\n\n    submit.addEventListener(&#39;click&#39;, function(event){\n        event.preventDefault();\n        var _this = this;                \n        var str = &#39;&#39;;\n        (new FormData(form)).forEach((v,k)=&gt;{\n            form_data[k]=v;\n            str += (k + &#39;=&#39; + v + &#39;&amp;&#39;);\n        });\n        str = &#39;?&#39;+str.slice(0,-1);\n        updata(str);\n    });\n}</code>\n        </deckgo-highlight-code>\n<h1>服务端 Server</h1>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">var http = require(&#39;http&#39;);\nvar url = require(&#39;url&#39;);\nvar fs = require(&#39;fs&#39;);\nvar querystring = require(&#39;querystring&#39;);\nvar products = null;\nfs.readFile(&#39;./products.json&#39;, (err,data)=&gt;{\n    if(err){\n        console.error(`读取products.json 出错:${err}`);\n    }\n    else{            \n        products = data.toString();\n        console.log(`读取products.json成功`);\n    }\n});\n\n\nhttp.createServer(function(rqs, rsp){\n    var path = url.parse(rqs.url).pathname;    \n    var querys = url.parse(rqs.url).query;\n    var keys_values = querystring.parse(querys);\n    var keys = Object.keys(keys_values);\n    \n    console.log(`请求path: ${path}`);\n    if(querys){\n        console.log(&#39;响应keys&#39;);\n        rsp.writeHead(200, {&#39;Content-Type&#39;:&#39;text/json&#39;});\n        rsp.write(JSON.stringify(products));\n        rsp.end();\n    }\n    else if(path.indexOf(&#39;html&#39;)&gt;-1 || path.indexOf(&#39;css&#39;)&gt;-1 || path.indexOf(&#39;js&#39;)&gt;-1){\n        fs.readFile(path.substr(1), (err,data)=&gt;{\n            if(err){\n                console.error(err);\n            }\n            else{\n                console.log(&#39;响应path&#39;);\n                rsp.writeHead(200, {&#39;Content-Type&#39;:&#39;text/html&#39;});\n                rsp.write(data.toString());\n                rsp.end();\n            }   \n        });\n    }    \n    else{\n        console.error(&#39;path is error!&#39;);\n        rsp.writeHead(404, {&#39;Content-Type&#39;:&#39;text/html&#39;});\n        rsp.write(&#39;error&#39;);\n        rsp.end();\n    }    \n}).listen(80);\n\nconsole.log(&#39;Start server......&#39;);</code>\n        </deckgo-highlight-code>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Learn/Server-side\">服务端网页编程-MDN</a> </p>","id":"82fd9085-5bd0-5647-9a0e-d5e8ca587b29","parent":{"__typename":"File","name":"客户端-服务端","base":"客户端-服务端.md","mtime":"2022-09-03T14:08:55.922Z","sourceInstanceName":"markdown"}}},"pageContext":{"articlePath":"/articles/前端/Node/客户端-服务端/"}},"staticQueryHashes":["3957182205"]}