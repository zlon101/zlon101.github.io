{"componentChunkName":"component---src-templates-post-js","path":"/articles/Vue/PWA/","result":{"data":{"markdownRemark":{"fields":{"articlePath":"/articles/Vue/PWA/"},"html":"<h1>PWA （渐进式/Web/application）</h1>\n<ul>\n<li>\n<p><strong>只能在<a href=\"http://localhost%E6%88%96%E8%80%85https%E4%B8%8B%E8%BF%90%E8%A1%8C\">http://localhost或者https下运行</a></strong></p>\n</li>\n<li>\n<p>持续关注PWA，积极研究其中应用场景，谷歌公司将现有的技术，结合起来推广的一整套的方案</p>\n</li>\n</ul>\n<ul>\n<li>\n<p>慢慢收服你（用户）</p>\n</li>\n<li>\n<p>离线浏览web应用，生成桌面应用，顶部通知（页面都可以不存在），预缓存（在你页面没有启动以前，请求资源保存到浏览器）（真正访问的时候，非常快，请求本地），骨架屏，App shell(利用缓存机制保存css+html+js等等)， 分享</p>\n</li>\n<li>\n<p>以上所有讲的东西，请大家把自己当产品经理来学习，以后再新技术上，chrome推出PWA但是一直没火起来。</p>\n</li>\n<li>\n<p>手机端 chrome 55以上才支持这些所有</p>\n<ul>\n<li>IOS11 safari 支持</li>\n</ul>\n</li>\n<li>\n<p>英文查看支持率 caniuse网站     中文就是lavas官网可以看到</p>\n</li>\n</ul>\n<h1>service worker</h1>\n<ul>\n<li>本质就是浏览器开启的一个线程（类似webworker），该线程可以拦截请求，发请求（类似node服务器）</li>\n</ul>\n<h1>SW生命周期</h1>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 579px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/b3291a35422f3f68ab952440d2ef5ced/c08bc/sw-lifecycle.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 149.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAACXBIWXMAAAsSAAALEgHS3X78AAAE60lEQVRIx4WVfY/jxg3G9f2/RoH+kQTptWlySVPcAX1Bu4tLsrn12euX9Zts2bJeLEsaaSTN6BdwbF22hwM6C4JcGiI5fB5yPNP3KGspb1JYSw0kcUwYBCRRRFWWzj4nCcXlQpamtH1P9Yl0fY+n+p7MXh1iVxIY+Nd8zg/39/zt3TvuFwv+ORrx9uGBNz//wj9GH1h3HbG1nG4i9sYYvK9KxVd5zndlydel4lVZ8k1RkPH7sTepJSkdVW+xVjw99DcB/K7D+3dd89cg4PV6zQ+7Ha99nx99H/90Ig5Dgv2eNEncR8Z2VHONyQ2d7VCqojMG3TQ0VcWmafBya9nv9vjTGcFyyW4+ZzWZMBmPWW827HY7wjB0FbSm4/BwokwUPT1Kqau/6+jqmm3b4EXWsI8P+P6WXRBQaU1rDE3T8OkxxhCfY0pV0vc9bds6LX6Mwe8avKS3hOme9XLOdDYjjmPO5zNFUVDXNVVVUZblRy2JxJbqBq0qRac1gW3xYtsSZ1OSKGQ2m7NarQiCgNPpRJ7nTi6Xi0sw6CzLSNPU/S/JkzRF5QWB0XixqQmTEf5mxbuffuLu7o67+3vG4zHL5ZLn52fW6zWLxYLNZuN8YotfkidJwimKSE4Ri0uMd7aaSieYWlOVymUSketd8txpuZZU9lLEJy3hSh53jrbGe1Uv+WMx50/qmS/rBV+qOV80z+SOef97uq5zQIgWMORPALmCYjkYhbfqMt6Hax63C37dLnj0n3nYLlhu1hyCAH/nu14NKFeqwliDUYbyg8a2PU3XolVN0OZ4Zd+y83dsps/slhu2ixXp4UQSxSRp4lCXioYKBVkJqJVm897HdOZaed1w6HK8gz0Ttim5KchMTtbllFR87ghlpG+im7ahUIUL1pmO3lpCk+O9bf7L18X3fFe+4Zvi73xbvOF1/pakPYO59kj6JrMrWoKJFr8115lu6w5TGkKT4aU2Z7x84vHDI0/zKY+TEU+zJ0ajEbPZzGmhiQQSIARdCSJSFqXDWB9a1EgT2hQvswUrf8NitnC8Wi1XzKYzF0w4JwSPosgFkOvJlUVLhWJLkkt2IT2lROaMd+lLN3rh8eg+Fo4N9HB0+ORIYEeZmzj0raE3PbE94wkEx3jFYj5lPJ6w3W7daA2zLFccZnkg88s5Fi0iKMdy5dxmpJcxcRTy9PTEZrNmv9+7lSWBh3mVmR60zPEg7vfsTJmXJDbBK2zOOZsSBgdGj2PGowmb1Zbj8Xgd/OTKRRFJMPikPUPQOIlJopRQB4JyQFxNiPMA/7RkH63JdOS284DmINJTx7sbKB/91riBPtsI79fuW+66L/i5e8VD+xd+af7Mf8wfKPv49mT83vyXxB6CO542Laa2pCbEu9iI6fY9z9spu9MaP1xxiH13peMNebmuBJVqBIChMplrlyjsUOOGswTUVlFWCtP1/L8zzPKwcQRl2TiX5EKyP5O3CV5VnmlkJquKpixpVUlbqY9Po9t3N3vg5zCKQx+brnEbp9IXvGy75TSZEM/nnKZTjpOJ01opzO2jzy2Hl+QfeqlVgWeahtVy6UbN324dDaRvwkPRQpNhK0s1Snr4op/uGW1baq1plMKT10pXFVprzG3vfXpkNYk0Wru+iW6bxtmdbCCtXeW6KPCslK1l8161PNiS5LNS17Q3eWm/9P0GyQjz/zXsG+MAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"sw-lifecycle\" title=\"sw-lifecycle\" src=\"/static/b3291a35422f3f68ab952440d2ef5ced/c08bc/sw-lifecycle.png\" srcset=\"/static/b3291a35422f3f68ab952440d2ef5ced/772e8/sw-lifecycle.png 200w,\n/static/b3291a35422f3f68ab952440d2ef5ced/e17e5/sw-lifecycle.png 400w,\n/static/b3291a35422f3f68ab952440d2ef5ced/c08bc/sw-lifecycle.png 579w\" sizes=\"(max-width: 579px) 100vw, 579px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>  \n<ul>\n<li><strong>install</strong>：Service Worker 安装成功后被触发的事件，在事件处理函数中可以添加需要缓存的文件（预先缓存资源）</li>\n<li><strong>activate</strong>：当 Service Worker 安装完成后并进入激活状态，会触发 activate 事件。通过监听 activate 事件你可以做一些预处理，如对旧版本的更新、对无用缓存的清理等。（检查更新资源）</li>\n<li><strong>message</strong>：Service Worker 运行于独立 context 中，无法直接访问当前页面主线程的 DOM 等信息，但是通过 postMessage API，可以实现他们之间的消息传递，这样主线程就可以接受 Service Worker 的指令操作 DOM。（浏览器与serviceworker通信的事件）</li>\n</ul>\n<h1>数据存储</h1>\n<ul>\n<li>\n<p>H5中的CacheAPI</p>\n</li>\n<li>\n<p>使用CacheAPI获取指定缓存的内容</p>\n<ul>\n<li>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">\n// 创建响应对象 开始\nvar debug = {hello: &quot;world&quot;};\nvar blob = new Blob([JSON.stringify(debug, null, 2)],\n  {type : &#39;application/json&#39;});\nvar init = { &quot;status&quot; : 200 , &quot;statusText&quot; : &quot;SuperSmashingGreat!&quot; };\nvar myResponse = new Response(blob,init);\n// 创建响应对象 结束\ncaches.open(&#39;key1&#39;).then(function(cachedRequests) { \n    cachedRequests.put(&#39;/def113&#39;,myResponse)\n  });</code>\n        </deckgo-highlight-code>\n</li>\n</ul>\n<h1>DB比较</h1>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/efa681280b1e29af31c350f1d4317af1/3534c/1530352193027.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByklEQVQoz12QW2sTURSF5++LFX1QQSxi6oPVGNFWY2tKbQzYsW1sii8+lV6STOaWOZk597ksOTshFg8cWOy9+PZieQ+33mGj1ab/oNXG1m4Pz9qfsPHyLZ53PuPRqw4ev/6A1s5XPNn+iPs072Kz0yX/0ze72Hzfxb0X29j/cQZvZzBEzz/Ht5MRDn+eY3/gr/WX/jGOTkfo+SP0h7/RP7vA4ckIe999HBwPcXR6gb2BT54D/xf+XN7Ai0UNYRu4V9c1ojBE0zRAAyRJSnNpG9hq6XGPMQYhBOkFYyjLar3zblKB60SgkBp5wXF5dQ2hNAouMA1CSKWR5BKMK0ilaBfMQsRpBqUNgjDCouAQUkMbCy/JFS2kNuBC4nY8BpeKQNNgBqUt2CJHxnIoY8k7iyKkGYOxJcIoRsElza0t4QVsCVQr4Hgy+Q9owLhGLvXaF8YJCiEpUeT0XWBSKGgy2lXCCS2FVJjOQtLzu0BjEcYx5mxBCR2QC/UPeJUKZHwJdVcn04B6csDxZErGlDpcppCrDl3fLqE76upwlbkDXpQbzIWBLUsyJGkKpTWMsUjnGWxZgQuBgnPS7meMEbCqa8RJilkYUbqyqvAXI6WZLdySb/0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1530352193027\"\n        title=\"1530352193027\"\n        src=\"/static/efa681280b1e29af31c350f1d4317af1/5a190/1530352193027.png\"\n        srcset=\"/static/efa681280b1e29af31c350f1d4317af1/772e8/1530352193027.png 200w,\n/static/efa681280b1e29af31c350f1d4317af1/e17e5/1530352193027.png 400w,\n/static/efa681280b1e29af31c350f1d4317af1/5a190/1530352193027.png 800w,\n/static/efa681280b1e29af31c350f1d4317af1/3534c/1530352193027.png 808w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1>缓存precaching</h1>\n<ul>\n<li>workbox-sw 一个工具库\n<ul>\n<li>预缓存静态资源<code>workbox.precaching.precacheAndRoute(['xxx'])</code></li>\n<li>动态缓存动态资源<code>workbox.routing.registerRoute(fn)</code></li>\n<li>缓存算法策略<code>workbox.strategies</code>\n<ul>\n<li>缓存优先 <code>cacheFirst()</code></li>\n<li>网络优先 <code>networkFirst()</code></li>\n<li>仅缓存<code>networkOnly()</code></li>\n<li>仅网络<code>networkOnly()</code></li>\n<li>Stale While Revalidate(缓存优先并更新缓存) <code>staleWhileRevalidate()</code></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>更新问题</h1>\n<ul>\n<li>\n<p>在service worker 中会缓存 service worker的具体行为</p>\n</li>\n<li>\n<p>让register-worker 每次请求新的service worker  就可以更改 缓存内容与缓存策略</p>\n</li>\n</ul>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">if(process.env.NODE_ENV === &#39;production&#39;){\n  register(`${process.env.BASE_URL}service-work.js?${Date.now()}`, {...})\n}</code>\n        </deckgo-highlight-code>\n<h1>兴趣补充</h1>\n<ul>\n<li>顶部通知 notification对象</li>\n<li>分享 navigator.share</li>\n</ul>","id":"fe2d1d4e-80d4-5a97-8f7b-5339eb6a3f04","parent":{"name":"PWA","base":"PWA.md","mtime":"2022-09-07T04:15:03.296Z","sourceInstanceName":"markdown"}}},"pageContext":{"articlePath":"/articles/Vue/PWA/"}},"staticQueryHashes":["3957182205"]}