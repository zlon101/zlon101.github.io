{"componentChunkName":"component---src-templates-post-js","path":"/articles/Gatsby建站/","result":{"data":{"markdownRemark":{"fields":{"articlePath":"/articles/Gatsby建站/"},"html":"<h1>搭建博客</h1>\n<ul>\n<li>Github + jekyll-now</li>\n<li>Gatsby：面向内容的React静态网站框架</li>\n<li>Next.js：使用Node构建服务端渲染的网站</li>\n<li>SwiftUI-App引用程序的用户界面</li>\n</ul>\n<h1>静态站点生成器</h1>\n<p>静态站点生成器融合了服务端渲染（对于 SEO 来说非常重要，也会影响初始加载时间）和单页应用程序的能力。</p>\n<p>如今，许多项目即使不需要服务端渲染也选择了一种 SSG，因为 Next 或 Nuxt 之类的解决方案具有很多便捷的功能，例如 markdown 支持、模块打包器和集成的测试运行器等。</p>\n<p>如果你很重视前端开发工作，则应仔细研究以下项目，并尝试获得一些实践经验：</p>\n<ul>\n<li>Next（基于 React）</li>\n<li>Nuxt（基于 Vue）</li>\n<li>Gatsby（基于 React）</li>\n<li>Gridsome（基于 Vue）</li>\n</ul>\n<p>这些可能是 2020 年最热门的项目，当然选项还有很多。如果你想了解关于它们的更多信息，请查看这些资源：</p>\n<ul>\n<li>Next.js</li>\n<li>Nuxt.js</li>\n<li>Gatsby</li>\n<li>Gridsome</li>\n</ul>\n<h1>Gatsby 学习</h1>\n<blockquote>\n<p>Gatsby是一个基于 React 架构的静态站点生成器，可以让你体验React的所有优点。Gatsby有一个预先配置好的Webpack，使用它入门React会省下很多麻烦，此外Gatsby会根据你的目录结构自动生成路由。所有的HTML都会在服务器端渲染，弥补了客户端渲染的不足。</p>\n</blockquote>\n<h2>参考</h2>\n<ul>\n<li><a href=\"https://www.gatsbyjs.cn/\">Gatsby中文文档</a>  </li>\n<li><a href=\"https://blog.crimx.com/archives\">搭建 Gatsby-博客</a>    <a href=\"https://github.com/crimx/blog-2019\">Gatsby博客源码</a> </li>\n<li><a href=\"https://www.gatsbyjs.org/starters/email2vimalraj/gatsby-starter-tech-blog/\">starter</a> </li>\n<li><a href=\"https://mp.weixin.qq.com/s/NavizDLQXav-N2cYda8Bhg\">使用 Gatsby.js 搭建静态博客黑暗模式</a> </li>\n<li><a href=\"https://www.gatsbyjs.com/blog/2017-07-19-creating-a-blog-with-gatsby/\">Creating a Blog with Gatsby</a>  </li>\n</ul>\n<h2>环境搭建</h2>\n<ul>\n<li>install Node and npm</li>\n<li>global install gatsby-cli:  <code>npm install -g gatsby-cli</code> </li>\n<li>创建项目：<code>gatsby new &#x3C;dir> [starter]</code> </li>\n<li>运行服务器：<code>gatsby develop</code> </li>\n<li>然后在pages目录下添加.md文件就能自动生成新博客文章了。\nGatsby 的核心自动把 <code>src/pages</code> 中的 React 组件转变为页面和 URL。比如：在 <code>src/pages/index.js</code> 和 <code>src/pages/about.js</code> 中的组件，会为网站的索引页（<code>/</code>）和 关于页（<code>/about</code>）自动创建基于文件名的页面。</li>\n<li><strong>命令</strong> </li>\n<li>npm i -g gatsby-cli</li>\n<li>gatsby new gatsby-blog <a href=\"https://github.com/gatsbyjs/gatsby-starter-blog\">https://github.com/gatsbyjs/gatsby-starter-blog</a> (这里使用了gatsby官方提供的一个blog模板)</li>\n<li>最后进入 gatsby-blog 文件夹，运行 gatsby develop</li>\n<li>构建：gatsby build；Gatsby将为您的站点执行优化的生产构建，生成<strong>静态HTML</strong>和每个路由的JavaScript代码包。</li>\n</ul>\n<p><strong>目录结构</strong> </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9db7663ec5559b1da2d3c758b4b923c6/97655/1562139626154.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQoz4VSi3KcMAzk///xLtMEMC+/n9hw25EuXJNpM/WMMNhotatVZ62F8x4xJ0ilYIyGthEhFhhjIKWEUgrOOf4OIeDxeOCn1R3HgWoc2iLhtMa8LJgmgWEY0Pc9tm1Daw17KeB/a0UpBTFGeO+RUkbKGa3sOGtDx5erRP4QyJtCP/R4u7/hdrvhdr/jqcDxTiAUIUQ4a5k5gfoQUGPCsVd0VL1ajygVtmXFPM/QWjMzAvHOY/k8O8+fpb4kU6V126CtwbKtGMeRk6lfBP4ENtxfbQwnUQ8pzvN8vV/BPWwxcRy5wHvHiWQGMaT7/62vJnVUpaWMKjUO7eCtw7pe0g2zJWfJZVLzNCK9zs5PsAu0o0c7DuzSQE8zhBAsV4iB3X5//4VxFPjoe3adgC7XcykXxT+APAoh4nSBd2biI2I+EVJDzA05Zy5ijOWRuZylluz7/p0hSa4pw0kFqw0UG0KjkhHiDusijNbcUzKGCFABCgKutf0tmahP0wQtZphlxbqtEGKE0QrzPL3cJlBi+pzJ9E9TfgOY01HnrPEOSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1562139626154\"\n        title=\"1562139626154\"\n        src=\"/static/9db7663ec5559b1da2d3c758b4b923c6/5a190/1562139626154.png\"\n        srcset=\"/static/9db7663ec5559b1da2d3c758b4b923c6/772e8/1562139626154.png 200w,\n/static/9db7663ec5559b1da2d3c758b4b923c6/e17e5/1562139626154.png 400w,\n/static/9db7663ec5559b1da2d3c758b4b923c6/5a190/1562139626154.png 800w,\n/static/9db7663ec5559b1da2d3c758b4b923c6/97655/1562139626154.png 819w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>  </p>\n<h2>部署</h2>\n<blockquote>\n<p>Gatsby构建命令生成一个包含静态HTML和JavaScript文件的目录，您可以将其部署到静态站点托管服务中。</p>\n</blockquote>\n<ul>\n<li>\"gh-pages -d build\"： Github 的 gh-pages 功能发布内容。</li>\n<li>build 后push到username.github.io/repos的master分支;</li>\n<li>绑定域名：在项目的根目录新建<code>static</code> 文件夹，然后添加<code>CNAME</code>文件，写上自己的域名。</li>\n<li>域名解析：</li>\n</ul>\n<p><a href=\"https://www.gatsbyjs.com/docs/tutorial/part-one/#deploying-a-gatsby-site\">参考</a>  </p>\n<h2>布局组件</h2>\n<blockquote>\n<p>布局包括：页眉、页脚、侧边栏、导航栏</p>\n</blockquote>\n<p><strong>利用两个插件实现 <code>.md</code> 到 <code>html</code> 的转换</strong> </p>\n<ul>\n<li><code>yarn add gatsby-transformer-remark gatsby-source-filesystem</code></li>\n<li><code>gatsby-source-filesystem</code> (Source plugins) 获取数据， <code>gatsby-transformer-remark</code> (<em>transformer</em> plugins) 对 markdown 文件解析后会生成 <code>MarkdownRemark</code> </li>\n<li><code>gatsby-transformer-remark</code> 解析 Markdown 并获取文件里面的数据</li>\n</ul>\n<p><strong>修改配置文件</strong></p>\n<ul>\n<li>\n<p>gatsby-config.js</p>\n<deckgo-highlight-code language=\"javascript\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">module.exports = {\nsiteMetadata: {\n  title: &#39;Gatsby Default Starter&#39;,\n},\nplugins: [\n  &#39;gatsby-plugin-react-helmet&#39;,\n  // 添加以下两个插件，一个用于读取md文件，一个用于转换其为html\n  &#39;gatsby-transformer-remark&#39;,\n  {\n    resolve: &#39;gatsby-source-filesystem&#39;,\n    options: {\n      name: &#39;src&#39;,\n      path: `${__dirname}/src`,\n    },\n  },\n],\n}</code>\n        </deckgo-highlight-code>\n</li>\n<li>frontmatter\n<code>/page</code>目录下.md文件中的‘---’ 隔开的部分(frontmatter: 网站的基本资料)会被 <code>gatsby-transformer-remark</code> 插件识别，并保存到 <code>frontmatter</code> 部分。可以通过 graphql 查询并用于页面渲染</li>\n</ul>\n<p><strong>模板</strong></p>\n<ul>\n<li>\n<p>templates</p>\n<deckgo-highlight-code language=\"javascript\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">//templates 模板\nimport React from &#39;react&#39;;\nimport Helmet from &#39;react-helmet&#39;;\n\nexport default function Template({data}) {\nconst {markdownRemark: post} = data;\nreturn (\n  &lt;div&gt;\n    &lt;h1&gt;{post.frontmatter.title}&lt;/h1&gt;\n  &lt;/div&gt;\n)\n}</code>\n        </deckgo-highlight-code>\n<p>参数 <code>data</code> 是由 GraphQL 传递进来的数据，也就是 Markdown 文件里面的内容。这些数据存放在markdownRemark变量当中，我们把它提取并存入post变量中，接着就可以透过<code>post.frontmatter.title</code> 使用 <code>frontmatter</code> 中的 <code>title</code> 内容。</p>\n</li>\n</ul>\n<p><strong>生成网页</strong> </p>\n<ul>\n<li><code>/src/pages/*.js</code> 目录下的组件会自动生成相应路径的页面，但如果是其它类型的文件就不会了。</li>\n<li>\n<p>我们用 GraphQL 取得所有的文章，用 foreach 针对每一篇文章使用 createPage 建立新页面，这里则需要用到 path 和 postTemplate</p>\n<deckgo-highlight-code language=\"js\" terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">createPage({\n\tpath: 页面对应的路由,\ncomponent: 模板组件,\ncontext: {}, // 传递给模板组件的上下文 props.pageContext, 用户 graphql 的参数查询\n})</code>\n        </deckgo-highlight-code>\n</li>\n</ul>\n<h2>数据查询(GraphQL)</h2>\n<blockquote>\n<p>Page queries live outside of the component definition — by convention at the end of a page component file — and are only available on page components.</p>\n<ul>\n<li>page components: <code>src/pages/*.js</code> 目录下的组件</li>\n<li>non-page components: 非 page components，如 Layout.js 不能使用 query 查询数据，改为 useStaticQuery</li>\n</ul>\n</blockquote>\n<deckgo-highlight-code  terminal=\"carbon\" theme=\"blackboard\"  >\n          <code slot=\"code\">frontmatter {\n\tdate(formatString: &quot;DD MMMM, YYYY&quot;)\n}\n\nallFile {\n\tnodes {\n\t\tname\n\t\trelativePath\n\t}\n}\n\nallMarkdownRemark {\n\tedges {\n\t  node {\n\t\t\thtml\n\t\t\tid\n\t\t\tfrontmatter {\n\t\t  \ttitle\n\t\t\t}\n\t\t\tparent {\n\t\t  \t... on File {\n\t\t\t\tname\n\t\t\t\trelativePath\n\t\t  }\n\t\t}\n\t  }\n\t}\n}</code>\n        </deckgo-highlight-code>\n<h2>动态创建页面</h2>\n<blockquote>\n<p>Gatsby 可以使用 GraphQL 查询数据并将查询结果映射为页面</p>\n<p>步骤：</p>\n<ol>\n<li>查询数据</li>\n<li>数据映射为页面</li>\n</ol>\n</blockquote>\n<p>当动态创建页面时，需要指定一个页面模板。</p>\n<h2>API</h2>\n<ul>\n<li><a href=\"https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#onCreateNode\"><code>onCreateNode</code></a> </li>\n<li><a href=\"https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#createPages\"><code>createPages</code></a> </li>\n</ul>","id":"c7cf066c-4357-50be-99a4-a09004a957e4","parent":{"__typename":"File","name":"Gatsby建站","base":"Gatsby建站.md","mtime":"2022-09-03T14:08:55.956Z","sourceInstanceName":"markdown"}}},"pageContext":{"articlePath":"/articles/Gatsby建站/"}},"staticQueryHashes":["3957182205"]}