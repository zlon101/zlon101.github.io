import{_ as o,J as n,o as p,c as t,k as a,a as s,N as r,w as c,V as l}from"./chunks/framework.33d73f2c.js";const i="/assets/image-20220424174427978.e377f014.png",y="/assets/image-20200714123919261.e294261a.png",D="/assets/image-20200726215312347.eaf2ddc2.png",d="/assets/image-20200726215731560.c37c0aa4.png",k=JSON.parse('{"title":"资源代理","description":"","frontmatter":{},"headers":[],"relativePath":"前端/前端调试.md","filePath":"前端/前端调试.md","lastUpdated":1691037194000}'),h={name:"前端/前端调试.md"},C=l('<h1 id="资源代理" tabindex="-1">资源代理 <a class="header-anchor" href="#资源代理" aria-label="Permalink to &quot;资源代理&quot;">​</a></h1><blockquote><p>目标：线上数据 + 本地代码</p></blockquote><h2 id="资源映射" tabindex="-1">资源映射 <a class="header-anchor" href="#资源映射" aria-label="Permalink to &quot;资源映射&quot;">​</a></h2><p>若只想把线上某些 JS、CSS 文件代理到本地，需要明确线上文件和本地开发环境中文件的 URI，比如线上 <code>http://xxx.com/a.js</code> 对应本地 <code>http://127.0.0.1/b.js</code>。建议编译前端资源时带上某些标识符，不然像 <code>chunk-7b00cddc18ef6832104e.js</code> 这种无法判断对应本地那个文件。</p><p>若前端是单页面项目， html 文件被代理后不需要考虑 js、css 文件的映射。</p><h2 id="工具" tabindex="-1">工具 <a class="header-anchor" href="#工具" aria-label="Permalink to &quot;工具&quot;">​</a></h2><ul><li><strong>Chrome</strong></li></ul><p><a href="chrome://version/" target="_blank" rel="noreferrer">查看chrome可执行文件路径、用户资料等</a></p>',8),u=l(`<div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">open </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">a </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Google Chrome dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">args </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">disable</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">web</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">security </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/xx/temp</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><ol start="2"><li>Chrome 可以不使用插件，用命令行启动浏览器并指定代理服务器</li></ol><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">/Applications/Google\\</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Chrome.app/Contents/MacOS/Google</span><span style="color:#A6ACCD;">\\ </span><span style="color:#C3E88D;">Chrome</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--disable-web-security</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--user-data-dir=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--proxy-server=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.0.0.1:8500</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--proxy-bypass-list=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;-loopback&gt;</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">chrome非安全模式</span></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">chrome</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://xx.com</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-–disable-extensions</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">–-disable-sync</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">–-disable-web-security</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-–proxy-server=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://127.0.0.1:8500</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><p>windows 中执行命令如下：</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">&quot;C:\\Program Files\\Google\\Chrome Dev\\Application\\chrome.exe&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--user-data-dir=D:</span><span style="color:#A6ACCD;">\\d</span><span style="color:#C3E88D;">ev-soft</span><span style="color:#A6ACCD;">\\c</span><span style="color:#C3E88D;">hrome-dev-user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--disable-web-security</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">serve</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tcp://127.0.0.1:3000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">D:</span><span style="color:#A6ACCD;">\\D</span><span style="color:#C3E88D;">esktop</span><span style="color:#A6ACCD;">\\p</span><span style="color:#C3E88D;">roxy</span></span></code></pre></div><p>部分参数只有在指定了 --user-data-dir 的情况下才生效，所以建议都指定 --user-data-dir</p><p>用命令行参数指定代理服务器可以解决无法将【本地 IP+端口】代理到其他本地IP的其他端口的问题</p><p><a href="https://himle.github.io/201609Chromium-%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0/" target="_blank" rel="noreferrer">chrome 启动命令</a> <a href="https://www.chromium.org/developers/how-tos/run-chromium-with-flags/" target="_blank" rel="noreferrer">官网</a> <a href="https://www.cnblogs.com/gurenyumao/p/14721035.html" target="_blank" rel="noreferrer">翻译</a> --incognito: 进入隐身模式——保证浏览网页时，不留下任何痕迹。 --disable-web-security: 不要强制执行同源策略</p><ul><li><p><a href="https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif?utm_source=chrome-ntp-icon" target="_blank" rel="noreferrer">SwitchyOmega</a> SwitchyOmega 作正向代理，将页面请求转发给其他服务器，页面可以是通过 IP 或域名访问，域名甚至可以是任意的假域名（实现跨域）。</p></li><li><p>如何将域名解析到本地IP？</p><ul><li>修改本地 <code>/etc/hosts</code></li><li>使用 SwitchHost 更方便的管理修改本地 hosts 文件，本质也是修改的 hosts 文件</li></ul></li><li><p>Nginx | AnyProxy 作为反向代理服务器，接收页面请求并转发给源服务器。</p></li></ul><h2 id="实现方案" tabindex="-1">实现方案 <a class="header-anchor" href="#实现方案" aria-label="Permalink to &quot;实现方案&quot;">​</a></h2><ol><li>vue 项目中通过配置 <code>vue.config.js</code> 的 <code>devServer.proxy</code> 字段实现代理，详情参考<a href="https://cli.vuejs.org/zh/config/#devserver-proxy" target="_blank" rel="noreferrer">devServer.proxy</a></li></ol><p><code>devServer.proxy</code> 匹配模式不能用 url 中的参数，没有在实际项目中使用。</p><ol start="2"><li><a href="https://github.com/yize/xswitch" target="_blank" rel="noreferrer">xSwitch</a> - Chrome 插件</li></ol><p>一个用来做请求链接转发的 Chrome 浏览器插件，因为采用的是浏览器原生 API，安全性和性能能得到保障。 将请求进行 Redirect ，不算代理，但可以应付简单的需求。比如将线上某个 JS、CSS 文件重定向到本地。</p><ol start="3"><li>Nginx 反向代理</li></ol><p>利用 Nginx 的 <code>proxy_pass</code> 终端配置反向代理，例如：</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    listen       9100;</span></span>
<span class="line"><span style="color:#A6ACCD;">    root ~/Desktop/dev;</span></span>
<span class="line"><span style="color:#A6ACCD;">    location /one {</span></span>
<span class="line"><span style="color:#A6ACCD;">        proxy_pass   http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1:3000/;</span></span>
<span class="line"><span style="color:#A6ACCD;">        add_header Cache-Control </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">no-cache, no-store, must-revalidate</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    location /two </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        proxy_pass   http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1:3100/;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    location / </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        proxy_pass   http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1:3100/;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>server 块标示一个<a href="https://developer.aliyun.com/article/539830" target="_blank" rel="noreferrer">虚拟主机</a>，此时我们如果调用的是 <code>http://localhost:9100</code> 时，会将这个请求转发到 <code>&lt;proxy_pass&gt;</code> 指定的端口上。</p><p>利用 Nginx 作反向代理需要配合 SwitchyOmega 插件或者修改本机 <code>/etc/hosts</code> 文件。</p><p>线上网址是通过 IP 或域名访问，可以配置 SwitchyOmega 插件将页面请求代理到 Nginx 监听的端口，再由 Nginx 进行转发。</p><p>若线上是通过域名访问，还可以不用 SwitchyOmega，通过修改 本机 <code>/etc/hosts</code> 文件，将域名解析到本地地址 (127.0.0.1)。<code>SwitchHost</code> 软件可以更方便的管理修改 <code>hosts</code> 文件。</p><p>用 Nginx 代理 https 服务需要配置证书，目前没有实现，了解的可以告知下。</p><ol start="4"><li><a href="https://youzan.github.io/zan-proxy/" target="_blank" rel="noreferrer">zan-proxy</a></li></ol><blockquote><p>NodeJs 开发的代理服务器，与用 Nginx 作代理服务器类似，需要配合 SwitchyOmega 或修改本机 hosts 文件。</p><p>个人体验不好用，代理规则贼难用，并且代理 https 失败，无法安装并信任证书，查阅资料说和电脑系统有关，没继续研究。</p></blockquote><ol start="5"><li><a href="https://github.com/alibaba/anyproxy" target="_blank" rel="noreferrer">AnyProxy</a></li></ol><blockquote><p>AnyProxy是一个基于NodeJS的，可供插件配置的 HTTP/HTTPS 代理服务器。与用 Nginx 作代理服务器类似，需要配合 SwitchyOmega 或修改本机 hosts 文件。</p><p>目前唯一成功代理 https 的方法</p></blockquote><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><blockquote><p>正向代理</p></blockquote><p>浏览器用 Chrome，实际使用中火狐浏览器无法代理 HTTPS 网址。</p><p>代理浏览器请求有两个方法：浏览器插件、命令行指定代理服务器</p><blockquote><p>反向代理</p></blockquote><p>转发请求到源服务器时，可以使用 nginx 或 anyproxy，实际使用中 nginx 无法代理 HTTPS 网址。</p><h1 id="anyproxy" tabindex="-1"><a href="https://github.com/alibaba/anyproxy" target="_blank" rel="noreferrer">AnyProxy</a> <a class="header-anchor" href="#anyproxy" aria-label="Permalink to &quot;[AnyProxy](https://github.com/alibaba/anyproxy)&quot;">​</a></h1><blockquote><p>AnyProxy是一个基于NodeJS的，可供插件配置的 HTTP/HTTPS 代理服务器。</p><p>线上前端资源代理到本地，浏览器访问线上地址，使用线上数据，将 web 资源代理到本地开发环境（<span style="color:red;">注意: 操作的是线上的数据</span> ）。</p><ul><li>代理服务器配置: api 走线上, web资源走本地</li><li>修改本地 api 配置, 改为生产环境, 使数据接口请求线上api地址</li></ul></blockquote><h2 id="步骤" tabindex="-1">步骤 <a class="header-anchor" href="#步骤" aria-label="Permalink to &quot;步骤&quot;">​</a></h2><ul><li>SwitchyOmega 配置</li></ul><p>正向代理，页面请求转发给其他代理服务器，可以是 AnyProxy 或者 Nginx 等。 <img src="`+i+`" alt="image-20220424174427978" style="zoom:50%;"></p><ul><li>AnyProxy 配置</li></ul><p>安装 AnyProxy 后配置代理规则，例如：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 使用线上的数据接口，将web资源代理到本地</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> whiteList </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">?ImageId=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">?n=xxx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">beforeSendRequest</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">reqCfg</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">whiteList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">every</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;font-style:italic;">s</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">reqCfg</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">includes</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#F07178;">))) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">nReqCfg</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reqCfg</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">requestOptions</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">reqCfg</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">protocol</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">nReqCfg</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hostname</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">127.0.0.1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">nReqCfg</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">port</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">8080</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reqCfg</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">beforeDealHttpsRequest</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">reqCfg</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><p>运行 anyproxy</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">anyproxy </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">intercept </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">ignore</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">unauthorized</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">ssl </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">rule </span><span style="color:#89DDFF;">./</span><span style="color:#A6ACCD;">proxy</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">rule</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">src</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">local</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">js</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 1. 若需要代理 https 添加 intercept 指令</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 2. 代理使用自签名证书的 https 网站时，若提示 Error: unable to verify the first certificate</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 则加 ignore-unauthorized-ssl 指令</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 3. rule 指令指定使用的代理规则文件</span></span></code></pre></div><h2 id="报错处理" tabindex="-1">报错处理 <a class="header-anchor" href="#报错处理" aria-label="Permalink to &quot;报错处理&quot;">​</a></h2><ul><li>页面报错: <code>Invalid Host header</code></li></ul><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 修改 vue.config.js 配置，设置本地开发环境服务器不检查 Host</span></span>
<span class="line"><span style="color:#A6ACCD;">devServer: </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  disableHostCheck</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">,</span></span></code></pre></div><ul><li><p>跨域：修改本地 api 接口为生产环境配置</p></li><li><p><a href="https://github.com/alibaba/anyproxy/issues/340" target="_blank" rel="noreferrer">访问自签名证书的 https 报错</a>：运行命令中增加 <code>--ignore-unauthorized-ssl</code></p></li><li><p><a href="https://github.com/FelisCatus/SwitchyOmega/issues/1762" target="_blank" rel="noreferrer">SwitchyOmega 不能代理本地地址</a></p><ul><li>用命令行启动chrome，在命令行参数中配置代理服务器</li><li>用 version-70 的 Chromium，<a href="https://vikyd.github.io/download-chromium-history-version/#/" target="_blank" rel="noreferrer">下载地址</a></li></ul></li><li><p>如果被代理的远程服务器是 HTTPS 协议，那本地开发服务器也需要是 HTTPS</p></li></ul><h2 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h2><blockquote><p>环境</p></blockquote><p>Mac: macOs Monterey v12.3.1</p><p>Node: v16.14.2</p><p>Chrome: 100.0.4896.127（正式版本） (x86_64)</p><p>anyproxy@4.1.3</p><p>SwitchyOmega: 2.5.21</p><blockquote><p>代理ZBH测试集群</p></blockquote><ul><li><p>运行 <code>zproxy sdp.test</code></p></li><li><p>SwitchyOmega 配置</p><ul><li><p>新建情景模式，代理服务器配置为，协议：http，IP：127.0.0.1，代理端口：8500（anyproxy 的代理端口）</p></li><li><p>Chrome 页面访问测试集群 <code>https://47.108.48.141:25605/</code></p></li><li><p>在该页面选中刚刚新建的那个 SwitchyOmega 模式</p></li><li><p>修改项目 <code>config.js</code> 文件 <code>host</code> 的值为生产环境下的值，解决跨域问题</p></li><li><p>修改 <code>vue.config.js</code> ，增加</p></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">devServer: {</span></span>
<span class="line"><span style="color:#A6ACCD;">  disableHostCheck: true</span></span>
<span class="line"><span style="color:#A6ACCD;">},</span></span></code></pre></div></li></ul><blockquote><p>代理 sdp beta</p></blockquote><ul><li>运行 <code>zproxy sdp.beta</code></li><li>剩余步骤同上</li></ul><h1 id="nginx-代理" tabindex="-1">nginx 代理 <a class="header-anchor" href="#nginx-代理" aria-label="Permalink to &quot;nginx 代理&quot;">​</a></h1><blockquote><p>nginx 代理 https</p></blockquote><ul><li><a href="https://tengine.taobao.org/nginx_docs/cn/docs/http/request_processing.html" target="_blank" rel="noreferrer">nginx如何处理一个请求-官网</a><a href="http://nginx.org/en/docs/beginners_guide.html" target="_blank" rel="noreferrer">http://nginx.org/en/docs/beginners_guide.html</a><a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#break" target="_blank" rel="noreferrer">http://nginx.org/en/docs/http/ngx_http_rewrite_module.html#break</a></li><li><a href="https://www.nginx.com/resources/wiki/start/topics/examples/full/" target="_blank" rel="noreferrer">https://www.nginx.com/resources/wiki/start/topics/examples/full/</a></li><li><a href="https://zhuanlan.zhihu.com/p/31202053" target="_blank" rel="noreferrer">nginx配置-知乎</a></li><li><a href="https://www.digitalocean.com/community/tools/nginx?global.app.lang=zhCN" target="_blank" rel="noreferrer">nginx 配置UI</a><a href="https://cloud.tencent.com/developer/article/1701547" target="_blank" rel="noreferrer">nginx location配置</a><a href="https://segmentfault.com/a/1190000022315733" target="_blank" rel="noreferrer">nginx location配置</a><a href="https://www.jianshu.com/p/a16936455018" target="_blank" rel="noreferrer">nginx location</a><a href="https://www.google.com/search?q=nginx+location+%E9%85%8D%E7%BD%AE&amp;oq=nginx+location+%E9%85%8D%E7%BD%AE&amp;aqs=chrome..69i57j0i30l6j69i61.5874j0j7&amp;sourceid=chrome&amp;ie=UTF-8" target="_blank" rel="noreferrer">nginx location</a></li></ul><blockquote><p>location</p></blockquote><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">location /js </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  proxy_pass   http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1:3000/demoJs;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>如果 proxy_pass 的 UR L定向里包括 URI，那么请求中匹配到 location 中 URI 的部分会被 proxy_pass 后面 URL 中的 URI 替换。</p><p>如果 proxy_pass 的 URL 定向里不包括 URI，那么请求中的 URI 会保持原样传送给后端 server。</p><p><code>$scheme://$host$request_uri</code></p><p>不知道页面请求的端口 $server_port $remote_port</p><h2 id="记录-思考" tabindex="-1">记录|思考 <a class="header-anchor" href="#记录-思考" aria-label="Permalink to &quot;记录|思考&quot;">​</a></h2><p>代理某个url，其他的请求不处理？</p><p>浏览器 转向 nginx nginx 将指定的url转发到 本地服务器，其他的转发到源服务器</p><ul><li><p>浏览器是否将web请求转发到 nginx ?</p><ul><li>https 代理</li><li>根据报错判断是哪个部分出错</li></ul></li><li><p>nginx 是否正确处理请求？</p></li><li><p>rewrite 和 proxy 区别？</p></li><li><p>nginx 开机启动</p></li></ul><h2 id="nginx-代理管理" tabindex="-1"><a href="https://nginxproxymanager.com/" target="_blank" rel="noreferrer">nginx 代理管理</a> <a class="header-anchor" href="#nginx-代理管理" aria-label="Permalink to &quot;[nginx 代理管理](https://nginxproxymanager.com/)&quot;">​</a></h2><p>Nginx 经常用作反向代理，这个工具为反向代理提供一个 Web 管理界面</p><h2 id="命令" tabindex="-1">命令 <a class="header-anchor" href="#命令" aria-label="Permalink to &quot;命令&quot;">​</a></h2><p>nginx -s</p><p>nginx -t</p><h1 id="xswitch" tabindex="-1"><a href="https://github.com/yize/xswitch" target="_blank" rel="noreferrer">xswitch</a> <a class="header-anchor" href="#xswitch" aria-label="Permalink to &quot;[xswitch](https://github.com/yize/xswitch)&quot;">​</a></h1><blockquote><p>一个用来做请求链接转发的 <a href="https://chrome.google.com/webstore/detail/xswitch/idkjhjggpffolpidfkikidcokdkdaogg" target="_blank" rel="noreferrer">Chrome 浏览器插件</a>，因为采用的是浏览器原生 <code>API</code>，安全性和性能能得到保障。</p></blockquote><h1 id="whlstle" tabindex="-1">Whlstle <a class="header-anchor" href="#whlstle" aria-label="Permalink to &quot;Whlstle&quot;">​</a></h1><blockquote><p>命令</p></blockquote><ul><li>w2 start/restart/stop</li><li>w2 start -p &lt;端口号&gt;</li></ul><blockquote><p>使用log 功能打印日志</p></blockquote><ul><li>/<a href="http://www.baidu.com/" target="_blank" rel="noreferrer">http://www.baidu.com/</a> log://</li></ul><h1 id="移动端真机调试" tabindex="-1"><a href="https://mp.weixin.qq.com/s/GIVylU3poibE-vIg6sLy9w" target="_blank" rel="noreferrer">移动端真机调试</a> <a class="header-anchor" href="#移动端真机调试" aria-label="Permalink to &quot;[移动端真机调试](https://mp.weixin.qq.com/s/GIVylU3poibE-vIg6sLy9w)&quot;">​</a></h1><blockquote><p>weinre 调试 spy-debugger调试</p></blockquote><ul><li><p>前端 将远程页面代理到本机进行调试</p></li><li><p>Charles 代理远程页面到本地，实际上访问本地资源。</p></li><li><p><a href="https://aotu.io/notes/2017/02/24/Mobile-debug/index.html" target="_blank" rel="noreferrer">移动端真机调试-凹凸实验室</a> <strong>重点</strong> switchHost &amp; Charles</p></li><li><p><a href="http://blog.ipalfish.com/?p=150" target="_blank" rel="noreferrer">前端页面调试</a></p><ul><li>Charles 代理 &amp; 移动端调试H5页面，</li><li>Android IOS 调试</li></ul></li><li><p><a href="https://cloud.tencent.com/developer/article/1032655" target="_blank" rel="noreferrer">抓包神器之Charles，常用功能都在这里了</a></p></li><li><p><a href="https://juejin.im/post/5b4f005ae51d45191c7e534a#heading-20" target="_blank" rel="noreferrer">Charles抓包</a></p><p><a href="#一安装与使用">一、安装与使用</a></p><p><a href="#二抓手机的请求包">二、抓手机的请求包</a></p><ul><li><a href="#http请求抓包">http请求抓包</a></li><li>https请求抓包 <ul><li><a href="#iphone手机抓https包">iPhone手机抓https包</a></li><li><a href="#安卓小米手机抓https包">安卓（小米）手机抓https包</a></li></ul></li></ul><p><a href="#三用本地文件替换线上文件">三、用本地文件替换线上文件</a></p><ul><li><a href="#替换测试环境的文件">替换测试环境的文件</a></li><li><a href="#替换生产环境的文件跨域">替换生产环境的文件（跨域）</a></li></ul><p><a href="#四其他">四、其他</a></p><ul><li><a href="#筛选指定域下的请求">筛选指定域下的请求</a></li></ul><p><a href="#参考文档">参考文档</a></p></li><li><p><a href="https://juejin.im/post/5bd673dc6fb9a05ce46a1333" target="_blank" rel="noreferrer">Charles代理到本地</a></p></li><li><p><a href="https://ningyu1.github.io/site/post/84-charles/" target="_blank" rel="noreferrer">Charles使用</a></p></li><li><p><a href="https://juejin.im/post/5ad045d2f265da2385334555" target="_blank" rel="noreferrer">https://juejin.im/post/5ad045d2f265da2385334555</a></p></li></ul><blockquote><p>需要注意的是，Chrome 和 Firefox 浏览器默认并不使用系统的代理服务器设置，而 Charles 是通过将自己设置成代理服务器来完成封包截取的，所以在默认情况下无法截取 Chrome 和 Firefox 浏览器的网络通讯内容。如果你需要截取的话，在 Chrome 中设置成使用系统的代理服务器设置即可，或者直接将代理服务器设置成 127.0.0.1:8888 也可达到相同效果。</p></blockquote><h2 id="ios调试" tabindex="-1"><a href="https://wiki.beisen-inc.com/pages/viewpage.action?pageId=230067462" target="_blank" rel="noreferrer">ios调试</a> <a class="header-anchor" href="#ios调试" aria-label="Permalink to &quot;[ios调试](https://wiki.beisen-inc.com/pages/viewpage.action?pageId=230067462)&quot;">​</a></h2><blockquote><p><a href="https://mp.weixin.qq.com/s/6pYUMtf_7fM_1Zg7qrNIAA" target="_blank" rel="noreferrer">使用 Safari 进行 UIWebView 的调试</a></p></blockquote><h2 id="h5-移动端调试" tabindex="-1"><a href="https://mp.weixin.qq.com/s/kaPGHiGI-ljPJQ5pqxE-5A" target="_blank" rel="noreferrer">H5 移动端调试</a> <a class="header-anchor" href="#h5-移动端调试" aria-label="Permalink to &quot;[H5 移动端调试](https://mp.weixin.qq.com/s/kaPGHiGI-ljPJQ5pqxE-5A)&quot;">​</a></h2><p>1.<code>Safari</code>：<code>iPhone</code> 调试利器，查错改样式首选； 2.<code>iOS</code> 模拟器：不需要真机，适合调试 <code>Webview</code> 和 <code>H5</code> 有频繁交互的功能页面； 3.<code>Charles</code>： <code>Mac OS</code> 系统首选的抓包工具，适合查看、控制网络请求，分析数据情况； 4.<code>Fiddler</code>：适合 <code>Windows</code> 平台，与 <code>Charles</code> 类似，查看、控制网络请求，分析数据情况； 5.<code>Spy-Debugger</code>：移动端调试的利器，便捷的远程调试手机页面、抓包工具； 6.<code>Whistle</code>：基于 <code>Node</code> 实现的跨平台 <code>Web</code> 调试代理工具； 7.<code>Chrome Remote Devices</code>：依赖 <code>Chrome</code> 来进行远程调试，适合安卓手机远程调试静态页； 8.<code>localhost</code> 转 <code>ip</code>：真机调试，适合远程调试静态页面； 9.<code>vConsole</code>：内置于项目，打印移动端日志，查看网络请求以及查看 <code>Cookie</code> 和 <code>Storage</code>；</p><h2 id="总结-1" tabindex="-1">总结 <a class="header-anchor" href="#总结-1" aria-label="Permalink to &quot;总结&quot;">​</a></h2><blockquote><p><strong>1.使用Chrome调试App中的WebView页面</strong></p></blockquote><p>将手机与电脑相连，并且打开手机的‘usb 调试’，然后在chrome中使用<code>chrome://inspect/</code> 查看页面DOM</p><ol><li>remote target中显示当前手机</li><li>手机上打开App调试包，调试包中包含了一段代码，有这段代码Chrome才能检测到WebView页面，</li><li>手机进入页面后<code>chrome://inspect/</code>中会显示该页面 <img src="`+y+'" alt="image-20200714123919261"></li></ol><blockquote><p><strong>2.使用代理让手机访问本地页面，然后进行调试</strong></p></blockquote><hr><h1 id="android-chrome调试移动端页面" tabindex="-1">Android &amp; Chrome调试移动端页面 <a class="header-anchor" href="#android-chrome调试移动端页面" aria-label="Permalink to &quot;Android &amp; Chrome调试移动端页面&quot;">​</a></h1><blockquote><p>调试App中的H5页面时，首先要让App访问的资源从远程服务器转向本地，然后将手机与电脑通过数据线连接，使用Chrome的提供的<code>chrome://inspect/#devices</code>工具进行调试。调试步骤如下：</p></blockquote><ol><li>打开手机上的&quot;usb调试&quot;选项，打开该选项后，当手机与电脑相连后才能在Chrome的<code>chrome://inspect/#devices</code>页面上查看到当前设备</li><li>手机上安装需要调试的App的<strong>调试包</strong>，打开App内的H5页面后就能在Chrome上看到对应的页面路径 <img src="'+D+'" alt="image-20200726215312347"> 上图中首页路径为<code>file://android_asset/xxx/index.html</code>，<code>file</code>协议说明打开的是手机内的本地页面，如果打开的远程页面则显示如下： <img src="'+d+`" alt="image-20200726215731560"></li></ol><blockquote><p>本地页面和远程页面的调试方式不同，以下分别介绍：</p></blockquote><ol><li><strong>调试远程页面</strong>：</li></ol><ul><li><p>远程页面包含的 html、js 等资源是在本地开发完成后部署到远程服务器上，手机也是访问远程服务器上的资源，所以不需要使用手机进行真机调试，不用将手机与电脑相连，调试步骤如下：</p></li><li><p>本地运行项目代码，比如：<code>npm run start</code>，该命令通常会运行一个 webpack 服务器(或者其他服务器)，</p><p>比如现在这个项目运行在本地的 3000 端口，在浏览器中通过 <code>http://0.0.0.0:3000/</code>、<code>http://127.0.0.1:3000/</code> 和 <code>http://localhost:3000/</code> 都能访问到该项目。</p><p>（<a href="https://juejin.im/post/5d258b6ae51d454f73356dcf" target="_blank" rel="noreferrer"><code>0.0.0.0</code>、<code>127.0.0.1</code>和<code>localhost</code>之间的区别</a>） 。</p></li><li><p>项目中如果有请求远程服务器上的数据时，通过 <code>localhost:3000</code> 和 IP 地址作为 URL 访问项目存在跨域问题，所以需要配置 nginx 进行代理，步骤如下：</p></li><li><p>在本地电脑上安装并运行 nginx ( nginx 是一款服务器)，安装成功后在终端输入 <code>nginx -v</code> 会显示 nginx 的版本。</p></li><li><p>修改 nginx 配置文件，该配置文件一般在<code>/usr/local/etc/nginx/nginx.conf</code> ，找不到的话可以在终端输入<code>find / -name &#39;nginx.config&#39;</code> 查找文件位置。</p></li><li><p>nginx的详细配置见 <a href="https://zhuanlan.zhihu.com/p/31202053%EF%BC%8C%E6%AD%A4%E5%A4%84%E5%8F%AA%E5%AF%B9%E7%94%A8%E5%88%B0%E7%9A%84%E5%87%A0%E4%B8%AA%E5%AD%97%E6%AE%B5%E8%AF%B4%E6%98%8E" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/31202053，此处只对用到的几个字段说明</a></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">    server_name abc.link; // 不能随便取，为了能解决跨域，需要填写指定的名字</span></span>
<span class="line"><span style="color:#A6ACCD;">    listen 80;</span></span>
<span class="line"><span style="color:#A6ACCD;">    root /xxx/xxx;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">        proxy_pass http://127.0.0.1:3000/;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>上述是一个 nginx.config 文件中的一个 server 区块，nginx 配置文件中的一个 server 区块表示一个虚拟主机，配置文件中可以包含多个 server 块。 <code>server_name abc.link;</code> 表示这个虚拟服务器的名字是 <code>abc.link</code>，我们在浏览器中输入 URL 时其中的域名部分就是 <code>abc.link</code>；<code>listen 80;</code>表示服务器监听的80端口，所以在 URL 中的端口就是80(可省略)，<code>root</code>指定了项目所在根目录，<code>location</code> 对应 URL 中的路径部分，<code>proxy_pass</code> 表示代理到 <code>http://127.0.0.1:3000/</code> 地址。</p><p style="color:red;">总结: 上述配置的效果就是，当我们在浏览器中输入 http://abc.link/ 时，浏览器实际访问的是 http://127.0.0.1:3000, 该地址就是执行 npm run start 时开启的本地项目所在地址。</p></li><li><p>在浏览器中输入 url 时，浏览器会根据对url中的域名进行解析得到域名对应的服务器ip地址，然后才能访问服务器上的资料。因为nginx服务器运行在本地电脑上，所以要让 abc.link 指向本机的ip(127.0.0.1)。所以设置 <a href="https://github.com/oldj/SwitchHosts" target="_blank" rel="noreferrer">SwitchHost</a> 为：<code>127.0.0.1 abc.link</code>。</p></li></ul><ol start="2"><li><strong>调试本地页面</strong></li></ol><ul><li><p>本地页面随App一起安装到手机，不需要网络也能访问，本地页面的路径如：<code>file://xxx/xxx</code>，</p></li><li><p>调试本地页面需要将手机和电脑相连，然后对手机进行代理，把手机访问的资源指向电脑本地资源路径，步骤如下：</p><ol><li><p>运行Charles，手机和电脑在同一个局域网下，连接同一个WiFi。进入Proxy---&gt;Proxy Settings设置代理，</p></li><li><p>修改手机网络，设置代理，&#39;服务器主机名&#39;填写电脑IP地址，端口与Charles设置的端口一致，</p></li><li><p>配置nginx，指定电脑上项目所在路径</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">    server_name appdebug.italent.link;</span></span>
<span class="line"><span style="color:#A6ACCD;">		listen       80;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    # talent-core</span></span>
<span class="line"><span style="color:#A6ACCD;">    location /new-italent-app {</span></span>
<span class="line"><span style="color:#A6ACCD;">        add_header Cache-Control &quot;no-cache, no-store, must-revalidate&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">        # new-italent-app的父级目录：</span></span>
<span class="line"><span style="color:#A6ACCD;">        root /Users/beisen/workspace/beisen/italent-app;</span></span>
<span class="line"><span style="color:#A6ACCD;">        autoindex on;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div></li><li><p>手机安装调试包，进入App，然后在<code>chrome://inspect/#devices</code>页面上就能看到手机上当前页面的路径，点击inspect就能开始调试本地页面了。</p></li></ol></li></ul><h1 id="chrome开发者工具" tabindex="-1">Chrome开发者工具 <a class="header-anchor" href="#chrome开发者工具" aria-label="Permalink to &quot;Chrome开发者工具&quot;">​</a></h1><p>调试面板说明 Style 面板中，优先级越高的规则，排列越靠前 Style 面板中：</p><ul><li>通过层叠规则被覆盖的 CSS 规则，使用<strong>删除线</strong>文本显示；</li><li><strong>灰色</strong>条目是未定义的规则，在运行时被计算样式取代了，不是继承的 Style (注：可以理解为无效的样式规则)；</li><li>computed 面板中灰色的 CSS 属性表示该属性未在 Style 面板中定义(包括默认的属性)；</li><li><a href="chrome://inspect/#devices" target="_blank" rel="noreferrer">Chrome 移动端调试地址</a></li></ul><h1 id="chrome-调试" tabindex="-1">Chrome 调试 <a class="header-anchor" href="#chrome-调试" aria-label="Permalink to &quot;Chrome 调试&quot;">​</a></h1><ul><li><p>console输出支持4种占位符：<code>%o d s f c</code>--&gt;对应4种类型的数据：对象、整数、字符串、浮点数和css样式</p><p>如：<code>console.log(&#39;对象：%o, %c整数：%d&#39;, {name:&#39;czl&#39;}, &#39;color: yellow&#39;, 23);</code><code>%c</code> 之后的文本使用指定的css样式输出；</p></li><li><p><code>console.group()</code> 和 <code>console.groupEnd()</code> 开启和关闭输出块；</p></li></ul><ol><li><p>清除指定代码位置之前的console并且屏蔽之后的console</p><ul><li>清除控制台之后的console.log、warn等输出：console.clear();</li><li>屏蔽console.log：console.log = ()=&gt;{}</li></ul></li><li><p>chrome控制台中选中DOM元素</p><ul><li>$(&#39;tagName&#39;) $(&#39;.class&#39;) $(&#39;#id&#39;) and $(&#39;.class #id&#39;) 等效于document.querySelector(&#39;&#39;)，返回与指定的CSS选择器相匹配的第一个元素；</li><li>$$(&#39;selector&#39;)：等效于document.querySelectorAll()，返回与指定的CSS选择器相匹配的所有元素的数组；</li><li>$0：</li></ul></li><li><p>查看某个DOM元素的事件监听器</p><ul><li><p>getEventListeners($(‘selector’)) 返回一个对象数组，其中包含绑定到该元素的所有事件。</p></li><li><p>getEventListeners($(‘selector’)).eventName[0].listener</p><p>如：getEventListeners($(‘firstName’)).click[0].listener：返回选中元素的点击事件的监听器；</p></li></ul></li><li><p>输出调用栈 console.trace()</p></li><li><p><code>console.dirxml($0)</code> 输出指定的节点包含的HTML</p></li><li><p>console.assert(a===b, a); 当条件判断为false时才输出</p></li><li><p>console.dir</p></li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#676E95;font-style:italic;">// 简单理解就是 document.querySelector 而已。</span></span>
<span class="line"><span style="color:#A6ACCD;">$$ </span><span style="color:#676E95;font-style:italic;">// 简单理解就是 document.querySelectorAll 而已。</span></span>
<span class="line"><span style="color:#A6ACCD;">$_ </span><span style="color:#676E95;font-style:italic;">// 是上一个表达式的值</span></span>
<span class="line"><span style="color:#A6ACCD;">$0</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">$4 </span><span style="color:#676E95;font-style:italic;">// 是最近5个Elements面板选中的DOM元素</span></span>
<span class="line"><span style="color:#A6ACCD;">dir </span><span style="color:#676E95;font-style:italic;">// 其实就是 console.dir</span></span>
<span class="line"><span style="color:#A6ACCD;">keys </span><span style="color:#676E95;font-style:italic;">// 取对象的键名, 返回键名组成的数组</span></span>
<span class="line"><span style="color:#A6ACCD;">values </span><span style="color:#676E95;font-style:italic;">// 去对象的值, 返回值组成的数组</span></span>
<span class="line"><span style="color:#82AAFF;">copy</span><span style="color:#A6ACCD;">($0) </span><span style="color:#676E95;font-style:italic;">// 拷贝选中节点的HTML到剪贴板</span></span></code></pre></div><ol start="7"><li><p><code>monitor(函数名)</code> 和 <code>unmonitor(函数名)</code> ：当指定的函数被调用时控制台输出一条消息</p></li><li><p>在线编辑网页</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">contentEditable </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">;</span></span></code></pre></div></li><li><p>获取DOM的事件处理程序</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> listens </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getEventListeners</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">$</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">selector</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">listens</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">click[</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">listener</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toString</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">monitorEvents</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dom</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">click</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mousedown</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">])</span></span>
<span class="line"><span style="color:#82AAFF;">unmonitorevent</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dom</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div></li></ol><blockquote><p><a href="https://juejin.im/post/5ca6bf5151882543fc5e3bb0" target="_blank" rel="noreferrer">灵活使用 console 让 js 调试更简单</a></p></blockquote><h1 id="vscode调试" tabindex="-1">vscode调试 <a class="header-anchor" href="#vscode调试" aria-label="Permalink to &quot;vscode调试&quot;">​</a></h1><blockquote><p>launch.json</p><p><a href="https://www.barretlee.com/blog/2019/03/18/debugging-in-vscode-tutorial/" target="_blank" rel="noreferrer">参考</a></p></blockquote><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">调试 Node.js 程序</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">request</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">launch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">//launsh | attach</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">// request，必填项，有两种类型，分别是 launch 和 attach，前者的意思就是 VSCode 会打开这个程序然后进入调试，后者的意思是你已经打开了程序，然后接通 Node.js 的内部调试协议进行调试</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">program</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\${workspaceFolder}/src/index.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">//程序的启动入口；</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  除了使用program字段指定程序入口，</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  还可以使用runtimeExecutable 和 args 启动程序</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  &quot;runtimeExecutable&quot;: &quot;node&quot;,  使用什么命令启动</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  &quot;args&quot;: [  启动时的参数</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    &quot;\${workspaceFolder}/src/index.js&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  ]</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><blockquote><p>launch.json</p></blockquote><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;type&quot;: &quot;node&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;request&quot;: &quot;launch&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;runtimeExecutable&quot;: &quot;node&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;runtimeArgs&quot;: [</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;-r&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;ts-node/register&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ],</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;args&quot;: [</span></span>
<span class="line"><span style="color:#A6ACCD;">    &quot;\${workspaceFolder}/src/index.ts&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p><code>runtimeArgs</code> 是为 <code>runtimeExecutable</code> 环境提供的配置，而 args 是为程序提供的配置。这个 JSON 的意思是：通过 node 来启动 <code>/src/index.ts</code>，在启动时为 node 注入一个 <code>ts-node/register</code> 模块，以便可以执行 ts 类型的文件。实际执行代码为：<code>node --inspect-brk=DEBUG_PORT -r ts-node/register ./src/index.ts</code></p><blockquote><p>属性解释</p></blockquote><ul><li><code>\${workspaceFolder}</code> ：给出工作区文件夹的根路径</li><li><code>\${file}</code>在活动编辑器中打开的文件</li></ul>`,121);function A(F,g,m,b,f,x){const e=n("font");return p(),t("div",null,[C,a("ol",null,[a("li",null,[s("如果页面所在 Origin 和跨域请求资源所在 Origin 都是 HTTP 协议，那么可以用以下命令启动 Chrome 并实现"),r(e,{color:"red"},{default:c(()=>[s("跨域请求")]),_:1}),s("，不需要服务端配置，也不用其他操作。")])]),u])}const _=o(h,[["render",A]]);export{k as __pageData,_ as default};
