<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.22.0"/><style data-href="/styles.f8ed7cdd0b842235ccf7.css" data-identity="gatsby-global-css">@-webkit-keyframes silde{0%{background-color:green}50%{background-color:blue}to{background-color:red}}@keyframes silde{0%{background-color:green}50%{background-color:blue}to{background-color:red}}.p-debug{margin:40px auto 0;outline:1px solid red;overflow:auto;padding:16px;position:relative;width:70vw}.p-debug .animation{background-color:red;height:200px;width:200px}.p-debug .animation.active{-webkit-animation:silde 10s infinite;animation:silde 10s infinite}.c-header{align-items:center;background-color:#fff;border-bottom:2px solid #eaecef;display:flex;height:48px;left:0;padding:8px 16px;position:fixed;top:0;width:100%;z-index:1000}.c-header>*{cursor:pointer;font-size:18px;font-weight:600;margin-right:18px}.c-header>:last-child{margin-left:auto;margin-right:0}.c-nav{min-height:calc(100vh - 48px);overflow:auto;padding:16px 16px 16px 0;position:-webkit-sticky;position:sticky;top:48px}.c-nav .file-item{display:block;margin:8px 0;white-space:nowrap}.c-nav .file-item.fold>.file-name:after{border-color:transparent transparent transparent #ccc;border-style:solid;border-width:6px 0 6px 9px;content:"";display:inline-block;height:0;margin-left:8px;transition:all .2s ease-out;width:0}.c-nav .file-item.fold.expand>.file-name:after{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.c-nav .file-item.fold.expand>.child-list{display:block}.c-nav .file-name{border-left:4px solid transparent;color:#2c3e50;cursor:pointer;display:block;font-size:16px;font-weight:700;margin-bottom:12px;padding-left:16px;position:relative}.c-nav .file-name.light{color:#3eaf7c;font-size:18px}.c-nav .child-list{display:none;margin:0;padding-left:16px;transition:all .2s ease-out}.c-layout-sidebar-content{display:flex;position:relative}.c-layout-sidebar-content .article-wrap{flex:1 1 auto}.c-layout-nav{border-right:2px solid #eaecef;max-width:300px;min-width:200px}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}*{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;margin:0;outline:0;padding:0}body,html{font-family:Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}p{line-height:1.5}a{color:#2c3e50;text-decoration:none}a:hover{text-decoration:underline}.page{padding-top:48px}.g-desc{color:#7f8fa4;font-size:14px}.icon-arrow{border-color:transparent transparent transparent blue;border-style:solid;border-width:44.5px 0 44.5px 118px;height:0;width:0}.icon-font{fill:currentColor;overflow:hidden;vertical-align:-.15em}.page-home-excerpt{background-color:#9cc;border:1px solid transparent;border-radius:6px;margin-bottom:24px;padding:16px}.page-home-excerpt-header{margin-bottom:4px}.page-home-excerpt-header-title{font-size:18px;font-weight:700}.page-home-excerpt-header-desc{color:#7f8fa4;font-size:14px;margin-left:8px}.page-home-excerpt-text{font-size:16px}.page-article-template .article-title-wrap{border-left:2px solid #eaecef;min-width:10%}.page-article-template .article-title-wrap .item{font-size:14px;font-weight:500}.page-article-template .article-title-wrap .item a{pointer-events:none}.page-article-template .article-title-list{padding:8px;position:-webkit-sticky;position:sticky;top:48px}.page-article-template .article-title-list .item{cursor:pointer;list-style:none;margin-bottom:12px}.page-article-template .article-title-list .item:hover{color:#3eaf7c;text-decoration:underline}.article-wrap{padding:0 8px 0 24px}.article-wrap h1{border-bottom:2px solid blue;font-size:16px;margin:36px 0}.article-wrap h2,.article-wrap h3,.article-wrap h4,.article-wrap h5,.article-wrap h6{border-bottom:2px solid blue;font-size:18px;margin:24px 0}.article-wrap div,.article-wrap p{margin:8px 0}.article-wrap a{color:#0969da}.article-wrap>:not(ul){margin-left:-14px}.article-wrap li{margin:8px 0}.article-wrap li ol,.article-wrap li ul{margin-left:12px}.article-wrap ol{margin-left:3px}.article-wrap blockquote{background-color:#fff5e3;border-left:.25em solid #ffb11b;color:#57606a;padding-left:24px}.article-wrap blockquote>p{margin-left:-16px}.article-wrap code{background-color:#fff5e3;border-radius:2px;color:#9b6e23;margin:0 2px;padding:3px 5px;white-space:nowrap}.article-wrap img{box-shadow:0 0 80px -30px rgba(0,0,0,.5)!important}.article-wrap table{border-collapse:collapse;border-spacing:0}.article-wrap table td,.article-wrap table th{background-color:#1f2329;border-bottom:1px solid rgba(220,223,230,.3);border-right:1px solid rgba(220,223,230,.3);color:#fff;padding:8px 16px;text-align:left}.article-title-wrap,.article-wrap{counter-reset:h1}.article-title-wrap h1,.article-wrap h1{counter-reset:h2}.article-title-wrap h1:before,.article-wrap h1:before{content:counter(h1) ". ";counter-increment:h1}.article-title-wrap h2,.article-wrap h2{counter-reset:h3}.article-title-wrap h2:before,.article-wrap h2:before{content:counter(h1) "." counter(h2) ". ";counter-increment:h2}.article-title-wrap h3,.article-wrap h3{counter-reset:h4}.article-title-wrap h3:before,.article-wrap h3:before{content:counter(h1) "." counter(h2) "." counter(h3) ". ";counter-increment:h3}.article-title-wrap h4,.article-wrap h4{counter-reset:h5}.article-title-wrap h4:before,.article-wrap h4:before{content:counter(h1) "." counter(h2) "." counter(h3) "." counter(h4) ". ";counter-increment:h4}.article-title-wrap h5,.article-wrap h5{counter-reset:h6}.article-title-wrap h5:before,.article-wrap h5:before{content:counter(h1) "." counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) ". ";counter-increment:h5}.article-title-wrap h6:before,.article-wrap h6:before{content:counter(h1) "." counter(h2) "." counter(h3) "." counter(h4) "." counter(h5) "." counter(h6) ". ";counter-increment:h6}</style></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="c-layout-wrap  page page-article-template"><header class="c-header"><a href="/">首页</a><a href="/">博客</a><a href="https://github.com/zlon101/npm-lib" target="_blank" rel="noreferrer noopener">vue组件指令</a><a href="/debug/">Debug</a><a href="https://github.com/zlon101" target="_blank" rel="noreferrer noopener"><svg class="icon-font" width="24px" height="24px" aria-hidden="true"><use href="#icon-font-github1"></use></svg></a></header><div class="c-layout-sidebar-content "><div class="c-layout-nav "><div class="c-nav"><div class="file-item fold false"><div class="file-name" role="button">博客</div><ul class="child-list"><a class="file-name false" href="/articles/博客/Gatsby建站/">Gatsby建站</a><a class="file-name false" href="/articles/博客/指南/">指南</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">Vue</div><ul class="child-list"><a class="file-name false" href="/articles/Vue/PWA/">PWA</a><a class="file-name false" href="/articles/Vue/vue2源码/">vue2源码</a><a class="file-name false" href="/articles/Vue/Vue技术栈/">Vue技术栈</a><a class="file-name false" href="/articles/Vue/vue基础概念/">vue基础概念</a><a class="file-name false" href="/articles/Vue/Vue视频资料/">Vue视频资料</a><a class="file-name false" href="/articles/Vue/服务端渲染/">服务端渲染</a><a class="file-name false" href="/articles/Vue/总结/">总结</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">React</div><ul class="child-list"><a class="file-name false" href="/articles/React/React基础/">React基础</a><a class="file-name false" href="/articles/React/React总结/">React总结</a><a class="file-name false" href="/articles/React/React技术栈/">React技术栈</a><a class="file-name false" href="/articles/React/TODO/">TODO</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">前端</div><ul class="child-list"><div class="file-item fold false"><div class="file-name" role="button">HTML-CSS</div><ul class="child-list"><a class="file-name false" href="/articles/前端/HTML-CSS/CSS基础/">CSS基础</a><a class="file-name false" href="/articles/前端/HTML-CSS/HTML基础/">HTML基础</a><a class="file-name false" href="/articles/前端/HTML-CSS/总结/">总结</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">JS</div><ul class="child-list"><a class="file-name false" href="/articles/前端/JS/ES6/">ES6</a><a class="file-name false" href="/articles/前端/JS/JS基础/">JS基础</a><a class="file-name false" href="/articles/前端/JS/总结/">总结</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">前端工程化</div><ul class="child-list"><a class="file-name false" href="/articles/前端/前端工程化/Babel/">Babel</a><a class="file-name false" href="/articles/前端/前端工程化/npm/">npm</a><a class="file-name false" href="/articles/前端/前端工程化/Gulp/">Gulp</a><a class="file-name false" href="/articles/前端/前端工程化/Webpack/">Webpack</a><a class="file-name false" href="/articles/前端/前端工程化/图标/">图标</a><a class="file-name false" href="/articles/前端/前端工程化/打包工具/">打包工具</a><a class="file-name false" href="/articles/前端/前端工程化/模块/">模块</a><a class="file-name false" href="/articles/前端/前端工程化/私有源/">私有源</a></ul></div><a class="file-name false" href="/articles/前端/webView/">webView</a><a class="file-name false" href="/articles/前端/前端调试/">前端调试</a><a class="file-name false" href="/articles/前端/前端资源整理/">前端资源整理</a><a class="file-name false" href="/articles/前端/浏览器/">浏览器</a><a class="file-name false" href="/articles/前端/总结/">总结</a><a class="file-name false" href="/articles/前端/规范/">规范</a><a class="file-name false" href="/articles/前端/设计模式/">设计模式</a><a class="file-name false" href="/articles/前端/练题/">练题</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">数据算法</div><ul class="child-list"><a class="file-name false" href="/articles/数据算法/数据结构基础/">数据结构基础</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">网络</div><ul class="child-list"><a class="file-name false" href="/articles/网络/HTTP/">HTTP</a><a class="file-name false" href="/articles/网络/代理/">代理</a><a class="file-name false" href="/articles/网络/服务端/">服务端</a><a class="file-name false" href="/articles/网络/网络基础/">网络基础</a></ul></div><div class="file-item fold false"><div class="file-name" role="button">服务端</div><ul class="child-list"><a class="file-name false" href="/articles/服务端/基础/">基础</a></ul></div><a class="file-name false" href="/articles/Linux命令/">Linux命令</a><a class="file-name false" href="/articles/Git/">Git</a><a class="file-name false" href="/articles/TS基础/">TS基础</a><a class="file-name false" href="/articles/vue3/">vue3</a><a class="file-name false" href="/articles/WebRTC/">WebRTC</a><a class="file-name false" href="/articles/微前端/">微前端</a><a class="file-name false" href="/articles/爬虫/">爬虫</a></div></div><article class="article-wrap"><h1 id="t-0" >页面生命周期</h1>
<ul>
<li>
<p>window.onload</p>
</li>
<li>
<p>window.onunload</p>
</li>
<li>
<p>window.onbeforeunload</p>
</li>
<li>
<p>document.addEventListener("DOMContentLoaded", fn);  DOMContentLoaded 只能用addEventListener监听</p>
</li>
<li>
<p>document.addEventListener('readystatechange', fn);</p>
<ul>
<li>对应 document.readyState 属性，取值：loading | interactive | complete</li>
<li>Loading: html 加载中</li>
<li>interactive: html加载完成, dom 解析完成，可以操作dom，但是js、图像等资源还在加载，触发 DOMContentLoaded 事件</li>
<li>complete: 资源完全加载，触发 window.onload</li>
</ul>
</li>
</ul>
<blockquote>
<p>参考 <a href="https://zh.javascript.info/onload-ondomcontentloaded">javascript.info</a></p>
</blockquote>
<h1 id="t-1" >viewport | 视口</h1>
<p>缩放改变的是 <code>window.devicePixelRatio</code></p>
<ul>
<li>
<p>布局视口：渲染后页面的实际大小，包含滚动情况下溢出的区域，页面缩放时（调整缩放级别）大小不变。</p>
</li>
<li>
<p>可见视口：页面可见的部分，缩放时尺寸不变的部分（地址栏、书签栏）都不算可见视口的区域。</p>
<ul>
<li>可见视口大小与窗口大小和缩放级别有关</li>
<li>如何读写？</li>
</ul>
</li>
</ul>
<deckgo-highlight-code language="js" terminal="carbon" theme="blackboard"  >
          <code slot="code">let pageWidth = window.innerWidth;
let pageHeight = window.innerHeight;
if (typeof pageWidth !== &#39;number&#39;) {
  if (document.compatMode === &#39;CSS1Compat&#39;) {
    pageWidth = document.documentElement.clientWidth;
    pageHeight = document.documentElement.clientHeight;
  } else {
    // 混杂模式
    pageWidth = document.body.clientWidth;
    pageHeight = document.body.clientHeight;
  }
}</code>
        </deckgo-highlight-code>
<ul>
<li><code>window.screen.availHeight\Width\Left\Top</code></li>
<li>网页缩放时布局视口、可见视口的变化？</li>
<li><a href="https://zh.javascript.info/popup-windows#yi-dong-he-tiao-zheng-da-xiao">https://zh.javascript.info/popup-windows#yi-dong-he-tiao-zheng-da-xiao</a></li>
</ul>
<blockquote>
<p>旧文档</p>
</blockquote>
<ul>
<li>
<p>布局视窗可以通过 <code>&#x3C;meta></code> 标签设置 viewport 来修改。每个浏览器默认都会有一个设置，例如iOS，Android这些机型设置布局视窗宽度为980px，所以PC上的网页基本能在手机上呈现，只不过元素看上去很小，一般可以通过手指动双击缩放网页。</p>
</li>
<li>
<p>控制放大和缩小的就是视窗Viewport</p>
</li>
<li>
<p>window.screen.width：获取屏幕的宽度，等于系统设置里面的屏幕分辨率，和页面没有关系（包括resize 、缩放）</p>
</li>
<li>
<p>什么是 viewport 视口</p>
<ul>
<li>可视区域，不包含滚动之外的内容</li>
<li>视口 === 布局视口 === document.documentElement.clientWidth</li>
<li>layout viewport | visual viewport (布局视口)</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Viewport">https://developer.mozilla.org/en-US/docs/Glossary/Viewport</a></li>
</ul>
</li>
<li>
<p><code>window.innerWidth</code>: visual viewport 的宽度。页面缩放会影响该值，放大时值变小。</p>
</li>
<li>
<p><code>window.outerWidth</code>: 整个浏览器窗口的尺寸，包含从标签页顶部的尺寸</p>
</li>
<li>
<p>获取文档尺寸</p>
</li>
</ul>
<deckgo-highlight-code language="js" terminal="carbon" theme="blackboard"  >
          <code slot="code">const scrollHeight = Math.max(
  document.body.scrollHeight, document.documentElement.scrollHeight,
  document.body.offsetHeight, document.documentElement.offsetHeight,
  document.body.clientHeight, document.documentElement.clientHeight
);</code>
        </deckgo-highlight-code>
<ul>
<li>获取浏览器视口大小</li>
</ul>
<deckgo-highlight-code language="javascript" terminal="carbon" theme="blackboard"  >
          <code slot="code">function getViewportSize() {
  // 混杂模式
  if (document.compatMode === &#39;BackCompat&#39;) {
    return {
      width: document.body.clientWidth,
      height: document.body.clientHeight,
    };
  }
  return {
    width: document.documentElement.clientWidth,
    height: document.documentElement.clientHeight,
  }
}</code>
        </deckgo-highlight-code>
<h1 id="t-2" >DOM操作</h1>
<h2 id="t-3" >元素尺寸</h2>
<blockquote>
<p>clientHeight  offsetHeight   scrollHeight</p>
</blockquote>
<p>clientWidth、offsetWidth、scrollWidth 都是只读属性，而且每次访问这些属性时都会重新计算。</p>
<img src="/dc828b194f6c868af738144cf344c946/DOM元素尺寸.svg" alt="DOM元素尺寸" style="zoom:67%;"> 
<ul>
<li><code>clientHeight</code> 内容区域加内边距，不包含滚动条和 border，可用于内容的文档的可见部分的 width/heigh，<code>inline</code> 元素获取的 clientWidth 和 clientHeight 为 0 ；</li>
<li><code>offsetWidth</code> 包含边框和滚动条的宽度，不包含伪元素 (::before、::after)</li>
<li><code>scrollHeight</code> 包含滚动隐藏尺寸，包含伪元素，如果元素没有溢出，该值等于 clientHeight</li>
</ul>
<blockquote>
<p>getBoundingClientRect</p>
</blockquote>
<p><strong>计算元素相对于视口的位置</strong></p>
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; ">
      <a class="gatsby-resp-image-link" href="/static/0af0c7d38022ec66861c3884bac8f339/ad997/image-20210702112944679.png" style="display: block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom: 77%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACb0lEQVQ4y5WUC4+bOBSF8/9/0u5WlbZPrbadziSThDdkCAFDEhKwMQ/zVSHtqBlNpV2kT9ey0PG510eenZw3yOR+ok7uUNkSJdb/kxVN4VI6fzI7B+/om5Je7unqHKMrGAdMrzF9+x/RjONIHX9hdg7fYwZNr08MXYUMF9T7LUNzpFeHHxxf4fDMoPac9imn8COzyn8PjWasz5gspv78BtXqyeVPRtPfMlzqAGa8Akg9UG2/Mau8v2mPB/LIpwss1PIttVhxTpack8cJJexpRk3h0OQOTeEh0zmt8DGn4yRYS00Vf2VWbT5PG9dzoNm75ElEttux2z6RJjF91/Py62SOzhzG6vSL4B2zKvp0FTRmGqzOLbI4YBP6xJHPU+jhO2u2m5BN4OJZS5I4pq0FrXAZz78THM3VYW4RBxaR7xL5DvbyAd9e4dlLAtcicNeILEOf00mwDyyG2KM6nn7M8KWgsIj9NaFnE14EnPVzvbgNPYtcCOQxps09zI3Dr685tPHWC1zbwlmvCDwXz7ZYP86xV0tca0Wxv8bmZoaqpdq+0rISS/LonjSckwb37PxvpOHDVLNojtgs6OpLyxFq9YEhtBnMwFMYUW3+fSE4Ql9s6TKPXvh0wp9qn4f0eXBdC58289DWPwxlAWZAnkoKUSDsd7/e8jBhqpKxUYxKwiXgqr4OPo0Zm2baH3WDiX2MrKa4TSG/tH1p+eB/QHUgmxbZdEjdIztDrXuKsqasG2QlkUojW4NsB1Q3kogDfXubT5UumJXOX8h0Rb1bPCN3C87bBxLrI4fwy/Sa1LvHm3/KzR1yN7++TunjFLfS/oPvG1RtFeTMZYoAAAAASUVORK5CYII='); background-size: cover; display: block;"></span>
  <img class="gatsby-resp-image-image" alt="image-20210702112944679" title="image-20210702112944679" src="/static/0af0c7d38022ec66861c3884bac8f339/5a190/image-20210702112944679.png" srcset="/static/0af0c7d38022ec66861c3884bac8f339/772e8/image-20210702112944679.png 200w,
/static/0af0c7d38022ec66861c3884bac8f339/e17e5/image-20210702112944679.png 400w,
/static/0af0c7d38022ec66861c3884bac8f339/5a190/image-20210702112944679.png 800w,
/static/0af0c7d38022ec66861c3884bac8f339/ad997/image-20210702112944679.png 1012w" sizes="(max-width: 800px) 100vw, 800px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;" loading="lazy" decoding="async">
  </a>
    </span> 
<ul>
<li>viewport 内(以可视区域的左上角为坐标原点)，盒模型左上角和右小脚的坐标（x, y）</li>
<li>ie 不支持 element.getBoundingClientRect().x</li>
</ul>
<deckgo-highlight-code language="javascript" terminal="carbon" theme="blackboard"  >
          <code slot="code">const rect = ele.getBoundingClientRect();
rect.right - rect.left === rect.width === ele.offsetWidth; // 三者相等</code>
        </deckgo-highlight-code>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect">https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect</a>
<a href="https://developer.mozilla.org/en-US/docs/Web/API/CSS_Object_Model/Determining_the_dimensions_of_elements">确定元素的尺寸-MDN</a></p>
<ul>
<li>getBoundingClientRect 无法使用时计算 <code>element.left</code> 和 <code>element.top</code></li>
</ul>
<deckgo-highlight-code language="javascript" terminal="carbon" theme="blackboard"  >
          <code slot="code">// 相对于 viewport 的偏移
function getElementLeft(ele, left = 0, top = 0) {
  if (!ele) return { left, top };
  const { offsetLeft, offsetTop } = ele;
  return getElementLeft(ele.offsetParent, left + offsetLeft, top + offsetTop)
}</code>
        </deckgo-highlight-code>
<h2 id="t-4" >元素位置</h2>
<ul>
<li>Element.clientTop/Element.clientLeft:  左/上边框的宽度，包含滚动条宽度，不含 margin、padding。</li>
<li>Element.offsetTop:  元素的边框相对于最近的定位祖先元素的边框的距离</li>
<li>Element.scrollTop:  元素内容区域滚动的距离</li>
</ul>
<h2 id="t-5" >监听元素变化</h2>
<ul>
<li>监听DOM元素变化: <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver/observe">MutationObserver</a> <a href="https://zh.javascript.info/mutation-observer">https://zh.javascript.info/mutation-observer</a></li>
<li>监听DOM元素尺寸变化: <a href="https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver">ResizeObserver</a> 、<a href="https://github.com/juggle/resize-observer">Polyfill</a></li>
<li>监听DOM元素是否可见: <a href="https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver">IntersectionObserver</a></li>
<li>DOMSubtreeModified DOMNodeInserted DOMNodeRemoved  DOMNodeInsertedIntoDocument  DOMNodeRemovedFromDocument DOMAttrModified DOMCharacterDataModified</li>
</ul>
<h2 id="t-6" >滚动</h2>
<ul>
<li>
<p><code>window.pageYOffset</code>
以左上角为坐标原点，页面水平、垂直滚动的距离，只读</p>
</li>
<li>
<p><code>window.scrollBy()</code>  和 <code>window.scrollTo()</code>
<code>window.scrollBy(x, y)</code> 相对于当前位置滚动，<code>window.scrollTo(x, y)</code> 相对于文档左上角滚动</p>
</li>
<li>
<p><code>document.documentElement.scrollTop</code> 和 <code>document.body.scrollTop/Left</code>（safari）、<code>ele.scrollTop</code>
垂直滚动距离，可读可写</p>
</li>
<li>
<p><code>ele.scrollIntoView</code></p>
</li>
<li>
<p><code>element.focus()</code> 也会导致页面滚动并显示获得焦点的元素</p>
</li>
<li>
<p>判断是否溢出</p>
</li>
</ul>
<deckgo-highlight-code language="js" terminal="carbon" theme="blackboard"  >
          <code slot="code">  ele.clientWidth &lt; ele.scrollWidth || ele.clientHeight &lt; ele.scrollHeight</code>
        </deckgo-highlight-code>
<blockquote>
<p><a href="https://zh.javascript.info/size-and-scroll-window">现代JS文档: size-and-scroll-window</a>
<a href="https://www.runoob.com/jqueryui/example-resizable.html">Jquery 拖拽 resize</a></p>
</blockquote>
<h1 id="t-7" >history</h1>
<blockquote>
<p>window.history.pushState | window.history.replaceState</p>
</blockquote>
<ul>
<li>pushState 和 replaceState 都会修改当前页面url，当时不会立即加载url，之后可能会加载url。</li>
<li>popstate事件只会在浏览器某些行为下触发， 比如点击后退、前进按钮(或者在JavaScript中调用history.back()、history.forward()、history.go()方法)。调用 history.pushState() 或者 history.replaceState() 不会触发 popstate 事件。</li>
</ul>
<h1 id="t-8" >Web Worker</h1>
<p>浏览器中 JavaScript 引擎是单线程执行的。也就是说，在同一时间内，只能有一段代码被 JavaScript 引擎执行。如果同一时间还有其它代码需要执行的话，则这些代码需要等待 JavaScript 引擎执行完成当前的代码之后才有可能获得被执行的机会。正常情况下，作为页面加载过程中的重要一步，JavaScript 引擎会顺序执行页面上的所有 JavaScript 代码。当页面加载完成之后，JavaScript 引擎会进入空闲状态。用户在页面上的操作会触发一些事件，这些事件的处理方法会交给 JavaScript 引擎来执行。由于 JavaScript 引擎的单线程特性，一般会在内部维护一个待处理的事件队列。每次从事件队列中选出一个事件处理方法来执行。如果在执行过程中，有新的事件发生，则新事件的处理方法只会被加入到队列中等待执行。如果当前正在执行的事件处理方法非常耗时，则队列中的其它事件处理方法可能长时间无法得到执行，造成用户界面失去响应，严重影响用户的使用体验。</p>
<ul>
<li>
<p>主线程<strong>异步</strong>创建 web worker，主线程代码不会阻塞在这里等待 worker 线程去加载、执行指定的脚本文件，而是会立即向下继续执行后面代码。</p>
</li>
<li>
<p>Web Worker 自身是由 webkit(浏览器内核) 多线程实现，但它并没有为 JavaScript 语言带来多线程编程特性，我们现在仍然不能在 JavaScript 代码中创建并管理一个线程，或者主动控制线程间的同步与锁等特性。</p>
</li>
</ul>
<p>在我看来，Web Worker 是 worker 编程模型在浏览器端 JavaScript 语言中的应用。浏览器的运行时, 同其他 GUI 程序类似，核心逻辑像是下面这个无限循环:</p>
<deckgo-highlight-code language="js" terminal="carbon" theme="blackboard"  >
          <code slot="code">while(true){  
  // 1 更新数据和对象状态  
  // 2 渲染可视化UI  
}</code>
        </deckgo-highlight-code>
<p>在 Web Worker 之前，JavaScript 执行引擎只能在一个单线程环境中完成这两项任务。而在其他典型 GUI 框架，如前文 Swing 库中，早已引入了 Swing Worker 来解决大量计算对 UI 渲染的阻塞问题。Web Worker 的引入，是借鉴了 worker 编程模型，给单线程的 JavaScript 带来了后台计算的能力。</p>
<blockquote>
<p>参考</p>
</blockquote>
<ul>
<li><a href="http://www.alloyteam.com/2015/11/deep-in-web-worker/#prettyPhoto">腾讯全端 AlloyTeam-Web Worker</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/web/1105_chengfu_jsworker/index.html">JS 工作线程实现方式-setTimeout &#x26; web worker</a>
setTimeout &#x26; setInterval 执行过程；</li>
</ul>
<h1 id="t-9" >实现动画的方法</h1>
<ol>
<li>css:  transition animation</li>
<li>js: setTimeout、setInterval、requestAnimationFrame</li>
<li><strong>html5: canvas ?</strong></li>
</ol>
<blockquote>
<p>参考</p>
</blockquote>
<ul>
<li><a href="https://threejs.org/examples/#webgl_decals">三维动画库</a></li>
<li><a href="https://www.cnblogs.com/coco1s/p/15009605.html">带圆角的三角形-动画</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Basic_animations">Animation</a></li>
</ul>
<h1 id="t-10" >特殊运算符</h1>
<blockquote>
<p><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Optional_chaining">可选链 空值运算符</a></p>
</blockquote>
<blockquote>
<p>void 0 &#x26; undefined</p>
</blockquote>
<p>undefined 不是 JS 中的保留字，而是全局对象的一个属性，在 ES5 之前是可修改的（<code>undefined = 1</code>），ES5 之后修改为只读属性，但是在局部作用域内依然可以覆盖 undefined 的值，如：<code>const undefined = 1;</code>。</p>
<blockquote>
<p>new this</p>
</blockquote>
<p>使用 <code>new</code> 实例化对象时构造函数内部<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new#description">执行步骤</a></p>
<ul>
<li>若执行 new Foo()，过程如下：</li>
</ul>
<p>1）创建新对象 o；
2）给新对象的内部属性赋值，关键是给[[Prototype]]属性赋值，构造原型链（如果构造函数的原型是 Object 类型，则指向构造函数的原型；不然指向 Object 对象的原型）；
3）执行函数 Foo，执行过程中内部 this 指向新创建的对象 o；
4）如果 Foo 内部显式返回对象类型数据，则返回该数据；否则返回新创建的对象 o。</p>
<ul>
<li>在 Person 函数体中判断函数是否已 <code>new</code> 调用</li>
</ul>
<ol>
<li><code>this instanceof Person</code></li>
<li>ES6 环境下: <code>new.target === Person</code></li>
</ol>
<h1 id="t-11" >String</h1>
<blockquote>
<p>概念</p>
</blockquote>
<p>16位 Unicode 字符 | 双字节字符</p>
<p>UTF-16 最多能表示 2^16=65536 个字符， 这 65536 个字符称为 basic multilingual plane (BMP) 字符集，可以用 <code>\uxxxx</code> 表示。</p>
<p>Unicode code points range from 0 to 1114111 (0x10FFFF). The first 128 Unicode code points are a direct match of the ASCII character encoding.</p>
<p>Unicode 字符集远大于 65536，超过的字符就用两个 UTF-16 编码单元(4字节)表示，这两个编码单元每个的取值在 0xD800 - 0xDFFF 范围。</p>
<p>每个 Unicode 字符由一个或两个 UTF-16 编码单元表示，又称 <strong>Unicode code point</strong>，用 <code>\u{xxxx}</code> 1到6位16进制数表示。</p>
<p>"unicode": "2764 FE0F",
"icon": "❤️"</p>
<p>"unicode": "1F525",
"icon": "🔥"</p>
<ul>
<li>
<p>😀</p>
<ul>
<li>length: 2</li>
<li>uncode: [\uD83D, \uDE00] => [55357, 56832]</li>
<li>转义表示:  \u{1f600}</li>
</ul>
</li>
<li>
<p>a</p>
<ul>
<li>ASCII:  97  0x60</li>
<li>转义表示: \u0061 或 \u{61}</li>
</ul>
</li>
</ul>
<blockquote>
<p>方法</p>
</blockquote>
<ul>
<li>String.prototype.charCodeAt  String.fromCharCode  ==> UTF-16 code unit</li>
<li>String.prototype.codePointAt  String.fromCodePoint  ==> Unicode code point</li>
<li>btoa  atob <a href="https://developer.mozilla.org/en-US/docs/Web/API/btoa">https://developer.mozilla.org/en-US/docs/Web/API/btoa</a></li>
</ul>
<blockquote>
<p>参考</p>
</blockquote>
<p><a href="https://zh.javascript.info/unicode">Unicode-javascript.info</a></p>
<h1 id="t-12" >Number</h1>
<p>在内部，数字是以 64 位格式 IEEE-754 表示的，所以正好有 64 位可以存储一个数字：1个符号位、11个指数位（exponent）、52个小数位（mantissa）。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/28b1da248e48f3dd5f49a2498e66a2eb/efb68/image-20230215135713259.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 35%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABFElEQVQoz42RbWvCMBCA+///0PbNzZf229gLsjmrQ6ct1dk2aUzbpOkzqigbCtvBQ+4S7ni4eLY2ZEnKZpVwLXZSskquv7Vte3HnLbYRt/MeN/Me7w8+0TBg7QesRj7rkc+iP+Dj7p7ID/gcjoiCgGV/QPL0jHPtYehPvDjd8CpCXrIJy/EjxcsYOZshwhAxDZHh7Ew+nR7PyRtpGNK27tKwkAUqK9BSk8cJRbJBaI3Y75FaU5TlGVVVyLKmsCAqkKpCSoGUkizL0FrjlWXJLk3Zfm3JhUAqRZ7nKKWwxlDXNeYXBmMajHXYxmGtPWCMoWkavFPSNXbDT7Vz7urS/wqva+6MOuU4jg9mQoijobXn3/wv32ouGVizdFUVAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image-20230215135713259"
        title="image-20230215135713259"
        src="/static/28b1da248e48f3dd5f49a2498e66a2eb/5a190/image-20230215135713259.png"
        srcset="/static/28b1da248e48f3dd5f49a2498e66a2eb/772e8/image-20230215135713259.png 200w,
/static/28b1da248e48f3dd5f49a2498e66a2eb/e17e5/image-20230215135713259.png 400w,
/static/28b1da248e48f3dd5f49a2498e66a2eb/5a190/image-20230215135713259.png 800w,
/static/28b1da248e48f3dd5f49a2498e66a2eb/c1b63/image-20230215135713259.png 1200w,
/static/28b1da248e48f3dd5f49a2498e66a2eb/29007/image-20230215135713259.png 1600w,
/static/28b1da248e48f3dd5f49a2498e66a2eb/efb68/image-20230215135713259.png 2032w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p><code>e</code> 等于 11 位指数位表示的数，最大为 2^11-1-1=1023，最小为1</p>
<p>11 位指数有两个特殊情况
1）全为0：当52位小数全为0时表示正负0，否则表示非规范化浮点数
2）全为1：当52位小数全为0时表示正负无穷大，否则表示 NaN</p>
<p>Integers can only be represented without loss of precision in the range  <code>-2^53 + 1 to 2^53 - 1</code>。<span style="color:red">实际测试为 -2^53 到 2^53</span></p>
<p>最大安全整数：Number.MAX_SAFE_INTEGER = 2^53</p>
<p><a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">双精度浮点数-Wiki</a></p>
<p>最大整数
精度丢失
isNaN
isFinite</p>
<h1 id="t-13" >eval</h1>
<p>参数：预期是字符串
返回值：若参数是字符串，返回值就是字符串执行的结果，否则返回值是输入参数本身</p>
<p>两种调用方式：
直接调用：eval()
间接调用：eval?.()、别名、对象属性、表达式</p>
<p>直接调用、间接调用的区别：</p>
<ul>
<li>
<p>是否继承上级作用域的 strict 模式</p>
<ul>
<li>间接调用不继承上级作用域的 'use strict' 模式，比如在一个声明了 'use strict' 的函数中以间接的方式调用 eval，eval 中代码是在非严格模式下执行</li>
<li>直接调用会继承 strict 模式</li>
</ul>
</li>
<li>
<p>执行环境（作用域）</p>
<ul>
<li>间接调用的执行作用域为全局作用域，eval 中的 script 不能访问局部作用域中的变量</li>
<li>直接调用的作用域为？</li>
<li>直接调用的 eval 可以访问访问其他上下文中的变量【危险，可能修改局部变量】</li>
</ul>
</li>
<li>
<p>变量声明和函数声明</p>
<ul>
<li>在非 strict 模式下，对于直接调用形式，var声明的变量和函数属于上级作用域(surrounding scope)，eval 中的代码可能修改外部的变量值；对于间接调用，var声明的变量和函数属于全局作用域</li>
<li>在 strict 模式下，var声明的变量和函数属于局部作用域，和调用方式无关</li>
<li>let 和 const 声明的变量始终属于局部作用域</li>
<li>直接 eval 会读取和修改周围作用域中的绑定，这可能导致外部输入破坏本地数据。</li>
</ul>
</li>
</ul></article><div class="article-title-wrap"><div class="article-title-list"><h1 data-id="0" class="item">页面生命周期</h1><h1 data-id="1" class="item">viewport | 视口</h1><h1 data-id="2" class="item">DOM操作</h1><h2 data-id="3" class="item">元素尺寸</h2><h2 data-id="4" class="item">元素位置</h2><h2 data-id="5" class="item">监听元素变化</h2><h2 data-id="6" class="item">滚动</h2><h1 data-id="7" class="item">history</h1><h1 data-id="8" class="item">Web Worker</h1><h1 data-id="9" class="item">实现动画的方法</h1><h1 data-id="10" class="item">特殊运算符</h1><h1 data-id="11" class="item">String</h1><h1 data-id="12" class="item">Number</h1><h1 data-id="13" class="item">eval</h1></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/articles/前端/JS/总结/";window.___webpackCompilationHash="b49c521d6dc75a12a1a0";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-38bff700e245e8493772.js"],"app":["/app-10896d9b1e770b1c82d9.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a1cb840e6fe8c403c00b.js"],"component---src-pages-debug-jsx":["/component---src-pages-debug-jsx-19f27fb8a0713cec9f30.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx-69e54fb59778b99df048.js"],"component---src-pages-other-js":["/component---src-pages-other-js-9c6c2b81a35ac0392fee.js"],"component---src-pages-repos-jsx":["/component---src-pages-repos-jsx-8504805d76fa72c3661f.js"],"component---src-templates-post-js":["/component---src-templates-post-js-93773b9ed0c07b2c71c7.js"]};/*]]>*/</script><script src="/polyfill-38bff700e245e8493772.js" nomodule=""></script><script src="/app-10896d9b1e770b1c82d9.js" async=""></script><script src="/framework-00aa2f30c053856ae873.js" async=""></script><script src="/webpack-runtime-dbb4c9a98e3509abf034.js" async=""></script></body></html>