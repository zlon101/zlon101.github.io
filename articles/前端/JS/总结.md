# é¡µé¢ç”Ÿå‘½å‘¨æœŸ

- window.onload
- window.onunload
- window.onbeforeunload
- document.addEventListener("DOMContentLoaded", fn);  DOMContentLoaded åªèƒ½ç”¨addEventListenerç›‘å¬

- document.addEventListener('readystatechange', fn);
  - å¯¹åº” document.readyState å±æ€§ï¼Œå–å€¼ï¼šloading | interactive | complete
  - Loading: html åŠ è½½ä¸­
  - interactive: htmlåŠ è½½å®Œæˆ, dom è§£æå®Œæˆï¼Œå¯ä»¥æ“ä½œdomï¼Œä½†æ˜¯jsã€å›¾åƒç­‰èµ„æºè¿˜åœ¨åŠ è½½ï¼Œè§¦å‘ DOMContentLoaded äº‹ä»¶
  - complete: èµ„æºå®Œå…¨åŠ è½½ï¼Œè§¦å‘ window.onload

å‚è€ƒ [javascript.info](https://zh.javascript.info/onload-ondomcontentloaded) 

# viewport | è§†å£

ç¼©æ”¾æ”¹å˜çš„æ˜¯ `window.devicePixelRatio` 


- å¸ƒå±€è§†å£ï¼šæ¸²æŸ“åé¡µé¢çš„å®é™…å¤§å°ï¼ŒåŒ…å«æ»šåŠ¨æƒ…å†µä¸‹æº¢å‡ºçš„åŒºåŸŸï¼Œé¡µé¢ç¼©æ”¾æ—¶ï¼ˆè°ƒæ•´ç¼©æ”¾çº§åˆ«ï¼‰å¤§å°ä¸å˜ã€‚

- å¯è§è§†å£ï¼šé¡µé¢å¯è§çš„éƒ¨åˆ†ï¼Œç¼©æ”¾æ—¶å°ºå¯¸ä¸å˜çš„éƒ¨åˆ†ï¼ˆåœ°å€æ ã€ä¹¦ç­¾æ ï¼‰éƒ½ä¸ç®—å¯è§è§†å£çš„åŒºåŸŸã€‚
  - å¯è§è§†å£å¤§å°ä¸çª—å£å¤§å°å’Œç¼©æ”¾çº§åˆ«æœ‰å…³
  - å¦‚ä½•è¯»å†™ï¼Ÿ

```js
let pageWidth = window.innerWidth;
let pageHeight = window.innerHeight;
if (typeof pageWidth !== 'number') {
  if (document.compatMode === 'CSS1Compat') {
    pageWidth = document.documentElement.clientWidth;
    pageHeight = document.documentElement.clientHeight;
  } else {
    // æ··æ‚æ¨¡å¼
    pageWidth = document.body.clientWidth;
    pageHeight = document.body.clientHeight;
  }
}
```

- `window.screen.availHeight\Width\Left\Top`
- ç½‘é¡µç¼©æ”¾æ—¶å¸ƒå±€è§†å£ã€å¯è§è§†å£çš„å˜åŒ–ï¼Ÿ
- https://zh.javascript.info/popup-windows#yi-dong-he-tiao-zheng-da-xiao

> æ—§æ–‡æ¡£

- å¸ƒå±€è§†çª—å¯ä»¥é€šè¿‡ `<meta>` æ ‡ç­¾è®¾ç½® viewport æ¥ä¿®æ”¹ã€‚æ¯ä¸ªæµè§ˆå™¨é»˜è®¤éƒ½ä¼šæœ‰ä¸€ä¸ªè®¾ç½®ï¼Œä¾‹å¦‚iOSï¼ŒAndroidè¿™äº›æœºå‹è®¾ç½®å¸ƒå±€è§†çª—å®½åº¦ä¸º980pxï¼Œæ‰€ä»¥PCä¸Šçš„ç½‘é¡µåŸºæœ¬èƒ½åœ¨æ‰‹æœºä¸Šå‘ˆç°ï¼Œåªä¸è¿‡å…ƒç´ çœ‹ä¸Šå»å¾ˆå°ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡æ‰‹æŒ‡åŠ¨åŒå‡»ç¼©æ”¾ç½‘é¡µã€‚

- æ§åˆ¶æ”¾å¤§å’Œç¼©å°çš„å°±æ˜¯è§†çª—Viewport
- window.screen.widthï¼šè·å–å±å¹•çš„å®½åº¦ï¼Œç­‰äºç³»ç»Ÿè®¾ç½®é‡Œé¢çš„å±å¹•åˆ†è¾¨ç‡ï¼Œå’Œé¡µé¢æ²¡æœ‰å…³ç³»ï¼ˆåŒ…æ‹¬resize ã€ç¼©æ”¾ï¼‰

- ä»€ä¹ˆæ˜¯ viewport è§†å£
  - å¯è§†åŒºåŸŸï¼Œä¸åŒ…å«æ»šåŠ¨ä¹‹å¤–çš„å†…å®¹
  - è§†å£ === å¸ƒå±€è§†å£ === document.documentElement.clientWidth
  - layout viewport | visual viewport (å¸ƒå±€è§†å£)
  - https://developer.mozilla.org/en-US/docs/Glossary/Viewport 

- `window.innerWidth`: visual viewport çš„å®½åº¦ã€‚é¡µé¢ç¼©æ”¾ä¼šå½±å“è¯¥å€¼ï¼Œæ”¾å¤§æ—¶å€¼å˜å°ã€‚
- `window.outerWidth`: æ•´ä¸ªæµè§ˆå™¨çª—å£çš„å°ºå¯¸ï¼ŒåŒ…å«ä»æ ‡ç­¾é¡µé¡¶éƒ¨çš„å°ºå¯¸

- è·å–æ–‡æ¡£å°ºå¯¸
```js
const scrollHeight = Math.max(
  document.body.scrollHeight, document.documentElement.scrollHeight,
  document.body.offsetHeight, document.documentElement.offsetHeight,
  document.body.clientHeight, document.documentElement.clientHeight
);
```

- è·å–æµè§ˆå™¨è§†å£å¤§å°
```javascript
function getViewportSize() {
  // æ··æ‚æ¨¡å¼
  if (document.compatMode === 'BackCompat') {
    return {
      width: document.body.clientWidth,
      height: document.body.clientHeight,
    };
  }
  return {
    width: document.documentElement.clientWidth,
    height: document.documentElement.clientHeight,
  }
}
```

# DOMæ“ä½œ

## å…ƒç´ å°ºå¯¸

> clientHeight  offsetHeight   scrollHeight

clientWidthã€offsetWidthã€scrollWidth éƒ½æ˜¯åªè¯»å±æ€§ï¼Œè€Œä¸”æ¯æ¬¡è®¿é—®è¿™äº›å±æ€§æ—¶éƒ½ä¼šé‡æ–°è®¡ç®—ã€‚

<img src="./assets/æ€»ç»“/DOMå…ƒç´ å°ºå¯¸.svg" alt="DOMå…ƒç´ å°ºå¯¸" style="zoom:67%;" /> 

- `clientHeight` å†…å®¹åŒºåŸŸåŠ å†…è¾¹è·ï¼Œä¸åŒ…å«æ»šåŠ¨æ¡å’Œ borderï¼Œå¯ç”¨äºå†…å®¹çš„æ–‡æ¡£çš„å¯è§éƒ¨åˆ†çš„ width/heighï¼Œ`inline` å…ƒç´ è·å–çš„ clientWidth å’Œ clientHeight ä¸º 0 ï¼›
- `offsetWidth` åŒ…å«è¾¹æ¡†å’Œæ»šåŠ¨æ¡çš„å®½åº¦ï¼Œä¸åŒ…å«ä¼ªå…ƒç´  (::beforeã€::after)
- `scrollHeight` åŒ…å«æ»šåŠ¨éšè—å°ºå¯¸ï¼ŒåŒ…å«ä¼ªå…ƒç´ ï¼Œå¦‚æœå…ƒç´ æ²¡æœ‰æº¢å‡ºï¼Œè¯¥å€¼ç­‰äº clientHeight

> getBoundingClientRect

**è®¡ç®—å…ƒç´ ç›¸å¯¹äºè§†å£çš„ä½ç½®** 

<img src="./assets/æ€»ç»“/image-20210702112944679.png" alt="image-20210702112944679" style="zoom:50%;" /> 

- viewport å†…(ä»¥å¯è§†åŒºåŸŸçš„å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹)ï¼Œç›’æ¨¡å‹å·¦ä¸Šè§’å’Œå³å°è„šçš„åæ ‡ï¼ˆx, yï¼‰
- ie ä¸æ”¯æŒ element.getBoundingClientRect().x

```javascript
const rect = ele.getBoundingClientRect();
rect.right - rect.left === rect.width === ele.offsetWidth; // ä¸‰è€…ç›¸ç­‰
```

https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect 
[ç¡®å®šå…ƒç´ çš„å°ºå¯¸-MDN](https://developer.mozilla.org/en-US/docs/Web/API/CSS_Object_Model/Determining_the_dimensions_of_elements) 

- getBoundingClientRect æ— æ³•ä½¿ç”¨æ—¶è®¡ç®— `element.left` å’Œ `element.top`
```javascript
// ç›¸å¯¹äº viewport çš„åç§»
function getElementLeft(ele, left = 0, top = 0) {
  if (!ele) return { left, top };
  const { offsetLeft, offsetTop } = ele;
  return getElementLeft(ele.offsetParent, left + offsetLeft, top + offsetTop)
}
```

## å…ƒç´ ä½ç½®

- Element.clientTop/Element.clientLeft:  å·¦/ä¸Šè¾¹æ¡†çš„å®½åº¦ï¼ŒåŒ…å«æ»šåŠ¨æ¡å®½åº¦ï¼Œä¸å« marginã€paddingã€‚
- Element.offsetTop:  å…ƒç´ çš„è¾¹æ¡†ç›¸å¯¹äºæœ€è¿‘çš„å®šä½ç¥–å…ˆå…ƒç´ çš„è¾¹æ¡†çš„è·ç¦»
- Element.scrollTop:  å…ƒç´ å†…å®¹åŒºåŸŸæ»šåŠ¨çš„è·ç¦»

## ç›‘å¬å…ƒç´ å˜åŒ–

- ç›‘å¬DOMå…ƒç´ å˜åŒ–: [MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver/observe) https://zh.javascript.info/mutation-observer
- ç›‘å¬DOMå…ƒç´ å°ºå¯¸å˜åŒ–: [ResizeObserver](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver) ã€[Polyfill](https://github.com/juggle/resize-observer) 
- ç›‘å¬DOMå…ƒç´ æ˜¯å¦å¯è§: [IntersectionObserver](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/IntersectionObserver) 

- DOMSubtreeModified DOMNodeInserted DOMNodeRemoved  DOMNodeInsertedIntoDocument  DOMNodeRemovedFromDocument DOMAttrModified DOMCharacterDataModified 

## æ»šåŠ¨

- `window.pageYOffset` 
  ä»¥å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ï¼Œé¡µé¢æ°´å¹³ã€å‚ç›´æ»šåŠ¨çš„è·ç¦»ï¼Œåªè¯»

- `window.scrollBy()`  å’Œ `window.scrollTo()` 
  `window.scrollBy(x, y)` ç›¸å¯¹äºå½“å‰ä½ç½®æ»šåŠ¨ï¼Œ`window.scrollTo(x, y)` ç›¸å¯¹äºæ–‡æ¡£å·¦ä¸Šè§’æ»šåŠ¨

- `document.documentElement.scrollTop` å’Œ `document.body.scrollTop/Left`ï¼ˆsafariï¼‰ã€`ele.scrollTop` 
  å‚ç›´æ»šåŠ¨è·ç¦»ï¼Œå¯è¯»å¯å†™
  
- `ele.scrollIntoView` 
- `element.focus()` ä¹Ÿä¼šå¯¼è‡´é¡µé¢æ»šåŠ¨å¹¶æ˜¾ç¤ºè·å¾—ç„¦ç‚¹çš„å…ƒç´ 

- åˆ¤æ–­æ˜¯å¦æº¢å‡º 
```js
  ele.clientWidth < ele.scrollWidth || ele.clientHeight < ele.scrollHeight
```

> [ç°ä»£JSæ–‡æ¡£: size-and-scroll-window](https://zh.javascript.info/size-and-scroll-window) 
> [Jquery æ‹–æ‹½ resize](https://www.runoob.com/jqueryui/example-resizable.html) 


# Web Worker

æµè§ˆå™¨ä¸­ JavaScript å¼•æ“æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ã€‚ä¹Ÿå°±æ˜¯åœ¨åŒä¸€æ—¶é—´å†…åªèƒ½æœ‰ä¸€æ®µä»£ç è¢« JavaScript å¼•æ“æ‰§è¡Œã€‚å¦‚æœåŒä¸€æ—¶é—´è¿˜æœ‰å…¶å®ƒä»£ç éœ€è¦æ‰§è¡Œçš„è¯ï¼Œåˆ™è¿™äº›ä»£ç éœ€è¦ç­‰å¾… JavaScript å¼•æ“æ‰§è¡Œå®Œæˆå½“å‰çš„ä»£ç ä¹‹åæ‰æœ‰å¯èƒ½è·å¾—è¢«æ‰§è¡Œçš„æœºä¼šã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒJavaScript å¼•æ“ä¼šé¡ºåºæ‰§è¡Œé¡µé¢ä¸Šçš„æ‰€æœ‰ JavaScript ä»£ç ã€‚å½“é¡µé¢åŠ è½½å®Œæˆä¹‹åï¼ŒJavaScript å¼•æ“ä¼šè¿›å…¥ç©ºé—²çŠ¶æ€ã€‚ç”¨æˆ·åœ¨é¡µé¢ä¸Šçš„æ“ä½œä¼šè§¦å‘ä¸€äº›äº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶çš„å¤„ç†æ–¹æ³•ä¼šäº¤ç»™ JavaScript å¼•æ“æ¥æ‰§è¡Œã€‚ç”±äº JavaScript å¼•æ“çš„å•çº¿ç¨‹ç‰¹æ€§ï¼Œä¸€èˆ¬ä¼šåœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå¾…å¤„ç†çš„äº‹ä»¶é˜Ÿåˆ—ã€‚æ¯æ¬¡ä»äº‹ä»¶é˜Ÿåˆ—ä¸­é€‰å‡ºä¸€ä¸ªäº‹ä»¶å¤„ç†æ–¹æ³•æ¥æ‰§è¡Œã€‚å¦‚æœåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰æ–°çš„äº‹ä»¶å‘ç”Ÿï¼Œåˆ™æ–°äº‹ä»¶çš„å¤„ç†æ–¹æ³•åªä¼šè¢«åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ­£åœ¨æ‰§è¡Œçš„äº‹ä»¶å¤„ç†æ–¹æ³•éå¸¸è€—æ—¶ï¼Œåˆ™é˜Ÿåˆ—ä¸­çš„å…¶å®ƒäº‹ä»¶å¤„ç†æ–¹æ³•å¯èƒ½é•¿æ—¶é—´æ— æ³•å¾—åˆ°æ‰§è¡Œï¼Œé€ æˆç”¨æˆ·ç•Œé¢å¤±å»å“åº”ï¼Œä¸¥é‡å½±å“ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒã€‚

- ä¸»çº¿ç¨‹**å¼‚æ­¥**åˆ›å»º web workerï¼Œä¸»çº¿ç¨‹ä»£ç ä¸ä¼šé˜»å¡åœ¨è¿™é‡Œç­‰å¾… worker çº¿ç¨‹å»åŠ è½½ã€æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬æ–‡ä»¶ï¼Œè€Œæ˜¯ä¼šç«‹å³å‘ä¸‹ç»§ç»­æ‰§è¡Œåé¢ä»£ç ã€‚

- Web Worker è‡ªèº«æ˜¯ç”± webkit(æµè§ˆå™¨å†…æ ¸) å¤šçº¿ç¨‹å®ç°ï¼Œä½†å®ƒå¹¶æ²¡æœ‰ä¸º JavaScript è¯­è¨€å¸¦æ¥å¤šçº¿ç¨‹ç¼–ç¨‹ç‰¹æ€§ï¼Œæˆ‘ä»¬ç°åœ¨ä»ç„¶ä¸èƒ½åœ¨ JavaScript ä»£ç ä¸­åˆ›å»ºå¹¶ç®¡ç†ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–è€…ä¸»åŠ¨æ§åˆ¶çº¿ç¨‹é—´çš„åŒæ­¥ä¸é”ç­‰ç‰¹æ€§ã€‚

åœ¨æˆ‘çœ‹æ¥ï¼ŒWeb Worker æ˜¯ worker ç¼–ç¨‹æ¨¡å‹åœ¨æµè§ˆå™¨ç«¯ JavaScript è¯­è¨€ä¸­çš„åº”ç”¨ã€‚æµè§ˆå™¨çš„è¿è¡Œæ—¶, åŒå…¶ä»– GUI ç¨‹åºç±»ä¼¼ï¼Œæ ¸å¿ƒé€»è¾‘åƒæ˜¯ä¸‹é¢è¿™ä¸ªæ— é™å¾ªç¯: 

```js
while(true){  
  // 1 æ›´æ–°æ•°æ®å’Œå¯¹è±¡çŠ¶æ€  
  // 2 æ¸²æŸ“å¯è§†åŒ–UI  
}
```

åœ¨ Web Worker ä¹‹å‰ï¼ŒJavaScript æ‰§è¡Œå¼•æ“åªèƒ½åœ¨ä¸€ä¸ªå•çº¿ç¨‹ç¯å¢ƒä¸­å®Œæˆè¿™ä¸¤é¡¹ä»»åŠ¡ã€‚è€Œåœ¨å…¶ä»–å…¸å‹ GUI æ¡†æ¶ï¼Œå¦‚å‰æ–‡ Swing åº“ä¸­ï¼Œæ—©å·²å¼•å…¥äº† Swing Worker æ¥è§£å†³å¤§é‡è®¡ç®—å¯¹ UI æ¸²æŸ“çš„é˜»å¡é—®é¢˜ã€‚Web Worker çš„å¼•å…¥ï¼Œæ˜¯å€Ÿé‰´äº† worker ç¼–ç¨‹æ¨¡å‹ï¼Œç»™å•çº¿ç¨‹çš„ JavaScript å¸¦æ¥äº†åå°è®¡ç®—çš„èƒ½åŠ›ã€‚

> å‚è€ƒ

- [è…¾è®¯å…¨ç«¯ AlloyTeam-Web Worker](http://www.alloyteam.com/2015/11/deep-in-web-worker/#prettyPhoto)
- [JS å·¥ä½œçº¿ç¨‹å®ç°æ–¹å¼-setTimeout & web worker](https://www.ibm.com/developerworks/cn/web/1105_chengfu_jsworker/index.html)
  setTimeout & setInterval æ‰§è¡Œè¿‡ç¨‹ï¼›


# å®ç°åŠ¨ç”»çš„æ–¹æ³•

1. css:  transition animation
2. js: setTimeoutã€setIntervalã€requestAnimationFrame
3. **html5: canvas ?** 

> å‚è€ƒ

- [ä¸‰ç»´åŠ¨ç”»åº“](https://threejs.org/examples/#webgl_decals) 
- [å¸¦åœ†è§’çš„ä¸‰è§’å½¢-åŠ¨ç”»](https://www.cnblogs.com/coco1s/p/15009605.html) 
- [Animation](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Basic_animations) 

# ç‰¹æ®Šè¿ç®—ç¬¦

> [å¯é€‰é“¾ ç©ºå€¼è¿ç®—ç¬¦](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Optional_chaining) 

> void 0 & undefined

undefined ä¸æ˜¯ JS ä¸­çš„ä¿ç•™å­—ï¼Œè€Œæ˜¯å…¨å±€å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œåœ¨ ES5 ä¹‹å‰æ˜¯å¯ä¿®æ”¹çš„ï¼ˆ`undefined = 1`ï¼‰ï¼ŒES5 ä¹‹åä¿®æ”¹ä¸ºåªè¯»å±æ€§ï¼Œä½†æ˜¯åœ¨å±€éƒ¨ä½œç”¨åŸŸå†…ä¾ç„¶å¯ä»¥è¦†ç›– undefined çš„å€¼ï¼Œå¦‚ï¼š`const undefined = 1;`ã€‚

> new this

ä½¿ç”¨ `new` å®ä¾‹åŒ–å¯¹è±¡æ—¶æ„é€ å‡½æ•°å†…éƒ¨[æ‰§è¡Œæ­¥éª¤](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new#description) 

- è‹¥æ‰§è¡Œ new Foo()ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š

1ï¼‰åˆ›å»ºæ–°å¯¹è±¡ oï¼›
2ï¼‰ç»™æ–°å¯¹è±¡çš„å†…éƒ¨å±æ€§èµ‹å€¼ï¼Œå…³é”®æ˜¯ç»™[[Prototype]]å±æ€§èµ‹å€¼ï¼Œæ„é€ åŸå‹é“¾ï¼ˆå¦‚æœæ„é€ å‡½æ•°çš„åŸå‹æ˜¯ Object ç±»å‹ï¼Œåˆ™æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹ï¼›ä¸ç„¶æŒ‡å‘ Object å¯¹è±¡çš„åŸå‹ï¼‰ï¼›
3ï¼‰æ‰§è¡Œå‡½æ•° Fooï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­å†…éƒ¨ this æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ oï¼›
4ï¼‰å¦‚æœ Foo å†…éƒ¨æ˜¾å¼è¿”å›å¯¹è±¡ç±»å‹æ•°æ®ï¼Œåˆ™è¿”å›è¯¥æ•°æ®ï¼›å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ oã€‚

- åœ¨ Person å‡½æ•°ä½“ä¸­åˆ¤æ–­å‡½æ•°æ˜¯å¦å·² `new` è°ƒç”¨

1. `this instanceof Person`
2. ES6 ç¯å¢ƒä¸‹: `new.target === Person`


# String

> æ¦‚å¿µ

16ä½ Unicode å­—ç¬¦ | åŒå­—èŠ‚å­—ç¬¦

UTF-16 æœ€å¤šèƒ½è¡¨ç¤º 2^16=65536 ä¸ªå­—ç¬¦ï¼Œ è¿™ 65536 ä¸ªå­—ç¬¦ç§°ä¸º basic multilingual plane (BMP) å­—ç¬¦é›†ï¼Œå¯ä»¥ç”¨ `\uxxxx` è¡¨ç¤ºã€‚

Unicode code points range from 0 to 1114111 (0x10FFFF). The first 128 Unicode code points are a direct match of the ASCII character encoding. 

Unicode å­—ç¬¦é›†è¿œå¤§äº 65536ï¼Œè¶…è¿‡çš„å­—ç¬¦å°±ç”¨ä¸¤ä¸ª UTF-16 ç¼–ç å•å…ƒ(4å­—èŠ‚)è¡¨ç¤ºï¼Œè¿™ä¸¤ä¸ªç¼–ç å•å…ƒæ¯ä¸ªçš„å–å€¼åœ¨ 0xD800 - 0xDFFF èŒƒå›´ã€‚

æ¯ä¸ª Unicode å­—ç¬¦ç”±ä¸€ä¸ªæˆ–ä¸¤ä¸ª UTF-16 ç¼–ç å•å…ƒè¡¨ç¤ºï¼Œåˆç§° **Unicode code point**ï¼Œç”¨ `\u{xxxx}` 1åˆ°6ä½16è¿›åˆ¶æ•°è¡¨ç¤ºã€‚

"unicode": "2764 FE0F",
"icon": "â¤ï¸"

"unicode": "1F525",
"icon": "ğŸ”¥"

- ğŸ˜€
  - length: 2
  - uncode: `[\uD83D, \uDE00]` => [55357, 56832]
  - è½¬ä¹‰è¡¨ç¤º:  `\u{1f600}`

- a
  - ASCII:  97  0x60
  - è½¬ä¹‰è¡¨ç¤º: `\u0061` æˆ– `\u{61}`

> æ–¹æ³•

- String.prototype.charCodeAt  String.fromCharCode  ==> UTF-16 code unit
- String.prototype.codePointAt  String.fromCodePoint  ==> Unicode code point
- btoa  atob https://developer.mozilla.org/en-US/docs/Web/API/btoa

> å‚è€ƒ

[Unicode-javascript.info](https://zh.javascript.info/unicode) 

# Number

åœ¨å†…éƒ¨ï¼Œæ•°å­—æ˜¯ä»¥ 64 ä½æ ¼å¼ IEEE-754 è¡¨ç¤ºçš„ï¼Œæ‰€ä»¥æ­£å¥½æœ‰ 64 ä½å¯ä»¥å­˜å‚¨ä¸€ä¸ªæ•°å­—ï¼š1ä¸ªç¬¦å·ä½ã€11ä¸ªæŒ‡æ•°ä½ï¼ˆexponentï¼‰ã€52ä¸ªå°æ•°ä½ï¼ˆmantissaï¼‰ã€‚

![image-20230215135713259](assets/æ€»ç»“/image-20230215135713259.png) 

`e` ç­‰äº 11 ä½æŒ‡æ•°ä½è¡¨ç¤ºçš„æ•°ï¼Œæœ€å¤§ä¸º 2^11-1-1=1023ï¼Œæœ€å°ä¸º1

11 ä½æŒ‡æ•°æœ‰ä¸¤ä¸ªç‰¹æ®Šæƒ…å†µ
1ï¼‰å…¨ä¸º0ï¼šå½“52ä½å°æ•°å…¨ä¸º0æ—¶è¡¨ç¤ºæ­£è´Ÿ0ï¼Œå¦åˆ™è¡¨ç¤ºéè§„èŒƒåŒ–æµ®ç‚¹æ•°
2ï¼‰å…¨ä¸º1ï¼šå½“52ä½å°æ•°å…¨ä¸º0æ—¶è¡¨ç¤ºæ­£è´Ÿæ— ç©·å¤§ï¼Œå¦åˆ™è¡¨ç¤º NaN

Integers can only be represented without loss of precision in the range  `-2^53 + 1 to 2^53 - 1`ã€‚<span style="color:red">å®é™…æµ‹è¯•ä¸º -2^53 åˆ° 2^53</span>

æœ€å¤§å®‰å…¨æ•´æ•°ï¼šNumber.MAX_SAFE_INTEGER = 2^53

[åŒç²¾åº¦æµ®ç‚¹æ•°-Wiki](https://en.wikipedia.org/wiki/Double-precision_floating-point_format) 

æœ€å¤§æ•´æ•°
ç²¾åº¦ä¸¢å¤±
isNaN
isFinite

> è§£å†³ç²¾åº¦é—®é¢˜

[mathjs](https://github.com/josdejong/mathjs/) 
[number-precision](https://github.com/nefe/number-precision) 

# eval

å‚æ•°ï¼šé¢„æœŸæ˜¯å­—ç¬¦ä¸²
è¿”å›å€¼ï¼šè‹¥å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿”å›å€¼å°±æ˜¯å­—ç¬¦ä¸²æ‰§è¡Œçš„ç»“æœï¼Œå¦åˆ™è¿”å›å€¼æ˜¯è¾“å…¥å‚æ•°æœ¬èº«

ä¸¤ç§è°ƒç”¨æ–¹å¼ï¼š
  ç›´æ¥è°ƒç”¨ï¼š`eval()`
  é—´æ¥è°ƒç”¨ï¼š`eval?.()`ã€åˆ«åã€å¯¹è±¡å±æ€§ã€è¡¨è¾¾å¼

ç›´æ¥è°ƒç”¨ã€é—´æ¥è°ƒç”¨çš„åŒºåˆ«ï¼š

- æ˜¯å¦ç»§æ‰¿ä¸Šçº§ä½œç”¨åŸŸçš„ strict æ¨¡å¼
  - é—´æ¥è°ƒç”¨ä¸ç»§æ‰¿ä¸Šçº§ä½œç”¨åŸŸçš„ 'use strict' æ¨¡å¼ï¼Œæ¯”å¦‚åœ¨ä¸€ä¸ªå£°æ˜äº† 'use strict' çš„å‡½æ•°ä¸­ä»¥é—´æ¥çš„æ–¹å¼è°ƒç”¨ evalï¼Œeval ä¸­ä»£ç æ˜¯åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹æ‰§è¡Œ
  - ç›´æ¥è°ƒç”¨ä¼šç»§æ‰¿ strict æ¨¡å¼


- æ‰§è¡Œç¯å¢ƒï¼ˆä½œç”¨åŸŸï¼‰
  - é—´æ¥è°ƒç”¨çš„æ‰§è¡Œä½œç”¨åŸŸä¸ºå…¨å±€ä½œç”¨åŸŸï¼Œeval ä¸­çš„ script ä¸èƒ½è®¿é—®å±€éƒ¨ä½œç”¨åŸŸä¸­çš„å˜é‡
  - ç›´æ¥è°ƒç”¨çš„ä½œç”¨åŸŸä¸ºï¼Ÿ
  - ç›´æ¥è°ƒç”¨çš„ eval å¯ä»¥è®¿é—®è®¿é—®å…¶ä»–ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ã€å±é™©ï¼Œå¯èƒ½ä¿®æ”¹å±€éƒ¨å˜é‡ã€‘


- å˜é‡å£°æ˜å’Œå‡½æ•°å£°æ˜
  - åœ¨é strict æ¨¡å¼ä¸‹ï¼Œå¯¹äºç›´æ¥è°ƒç”¨å½¢å¼ï¼Œvarå£°æ˜çš„å˜é‡å’Œå‡½æ•°å±äºä¸Šçº§ä½œç”¨åŸŸ(surrounding scope)ï¼Œeval ä¸­çš„ä»£ç å¯èƒ½ä¿®æ”¹å¤–éƒ¨çš„å˜é‡å€¼ï¼›å¯¹äºé—´æ¥è°ƒç”¨ï¼Œvarå£°æ˜çš„å˜é‡å’Œå‡½æ•°å±äºå…¨å±€ä½œç”¨åŸŸ
  - åœ¨ strict æ¨¡å¼ä¸‹ï¼Œvarå£°æ˜çš„å˜é‡å’Œå‡½æ•°å±äºå±€éƒ¨ä½œç”¨åŸŸï¼Œå’Œè°ƒç”¨æ–¹å¼æ— å…³
  - let å’Œ const å£°æ˜çš„å˜é‡å§‹ç»ˆå±äºå±€éƒ¨ä½œç”¨åŸŸ
  - ç›´æ¥ eval ä¼šè¯»å–å’Œä¿®æ”¹å‘¨å›´ä½œç”¨åŸŸä¸­çš„ç»‘å®šï¼Œè¿™å¯èƒ½å¯¼è‡´å¤–éƒ¨è¾“å…¥ç ´åæœ¬åœ°æ•°æ®ã€‚

# æ±‚å€¼ç­–ç•¥

æ±‚å€¼ç­–ç•¥æœ‰ä¸¤ç§ï¼š
- ä¼ å€¼è°ƒç”¨ï¼Œå…ˆæŠŠå˜é‡çš„å€¼è®¡ç®—å‡ºæ¥ï¼Œç„¶åç›´æ¥ä½¿ç”¨è®¡ç®—å‡ºæ¥çš„å€¼
- ä¼ åè°ƒç”¨ï¼Œç­‰åˆ°éœ€è¦å˜é‡çš„å€¼æ—¶æ‰è®¡ç®—

JS é‡‡ç”¨çš„ä¼ å€¼è°ƒç”¨ï¼ŒECMAScript ä¸­æ‰€æœ‰çš„å‡½æ•°çš„å‚æ•°éƒ½æ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚

```js
let a = {n: 1};
let b = a;
let num = 0;
a.x = (a = {n: 2});
console.log('a: ', a)
console.log('b: ', b)
// ç»“æœï¼š
a:  {n: 2}
b: {n: 1, x: {n: 2}}
```